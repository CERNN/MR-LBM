dfloat rho_I;
dfloat inv_rho_I;

dfloat pixx_I;
dfloat pixy_I;
dfloat pixz_I;
dfloat piyy_I;
dfloat piyz_I;
dfloat pizz_I;

dfloat rho;
dfloat inv_rho;

dfloat uxVar;
dfloat uyVar;
dfloat uzVar;

dfloat bE;
dfloat dE;

switch (nodeType){
        case BULK:
            break;

        //corners
        case SOUTH_WEST_BACK:
            // l1 = -1
            // l2 = -1
            // l3 = -1
            uxVar = 0.0;  
            uyVar = 0.0;  
            uzVar = 0.0; 

            //IO: 0/2/4/6/8/10/12
            rho_I = pop[0]  + pop[2] + pop[4] + pop[6] + pop[8] + pop[10] + pop[12];
            inv_rho_I = 1.0 / rho_I;
            pixx_I = inv_rho_I *  (pop[2] + pop[8] + pop[10] - cs2*rho_I);
            pixy_I = inv_rho_I * ((pop[8]) );
            pixz_I = inv_rho_I * ((pop[10]) ) ;
            piyy_I = inv_rho_I *  (pop[4] + pop[8] + pop[12] - cs2*rho_I);
            piyz_I = inv_rho_I * ((pop[12]) );
            pizz_I = inv_rho_I *  (pop[6] + pop[10] + pop[12] - cs2*rho_I);
            

            bE = (1.0/24.0)*(T_OMEGA)*(pixx_I + piyy_I + pizz_I 
                    +2.0 * pixy_I + 2.0 * pixz_I + 2.0 * piyz_I);
            dE = 4.0 + 10.0*OMEGA + 4*(OMEGA-3.0)*(-uxVar - uyVar - uzVar) 
                    - 9.0*OMEGA*(uxVar*uxVar + uyVar*uyVar + uzVar*uzVar) + 6.0* OMEGA *
                    ( uxVar * uyVar + uxVar * uzVar + uyVar*uzVar);

            rho = rho_I * bE / dE; //A27
            inv_rho = 1.0/rho;

            pixx_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pixx_I - 2.0*piyy_I - 2.0 * pizz_I + 6.0*(-pixy_I - pixz_I + piyz_I)) + (2.0/9.0) * (1.0 + 2.0*uxVar - uyVar - uzVar));
            piyy_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * piyy_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(-pixy_I - piyz_I + pixz_I)) + (2.0/9.0) * (1.0 + 2.0*uyVar - uxVar - uzVar));
            pizz_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pizz_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(-pixz_I - piyz_I + pixy_I)) + (2.0/9.0) * (1.0 + 2.0*uzVar - uxVar - uyVar)); 
            pixy_t90 = 9.0 * (inv_rho * ONETHIRD * (-3.0 * pixx_I -3.0 * piyy_I + 3.0* pizz_I + 17.0*pixy_I - pixz_I - piyz_I) - (2.0/9.0) * (1.0 - uyVar - uxVar - uzVar));
            pixz_t90 = 9.0 * (inv_rho * ONETHIRD * (-3.0 * pixx_I -3.0 * pizz_I + 3.0* piyy_I + 17.0*pixz_I - pixy_I - piyz_I) - (2.0/9.0) * (1.0 - uzVar - uxVar - uyVar));
            piyz_t90 = 9.0 * (inv_rho * ONETHIRD * (-3.0 * piyy_I -3.0 * pizz_I + 3.0* pixx_I + 17.0*piyz_I - pixy_I - pixz_I) - (2.0/9.0) * (1.0 - uzVar - uyVar - uxVar));

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho; 
            break;
        case SOUTH_WEST_FRONT:
            // l1 = -1
            // l2 = -1
            // l3 = +1
            uxVar = 0.0;  
            uyVar = 0.0;  
            uzVar = 0.0; 

            //IO: 0/2/4/5/8/16/18
            rho_I = pop[0]  + pop[2] + pop[4] + pop[5] + pop[8] + pop[16]  + pop[18];
            inv_rho_I = 1.0 / rho_I;
            pixx_I = inv_rho_I *  (pop[2] + pop[8] + pop[16] - cs2*rho_I);
            pixy_I = inv_rho_I * (( pop[8]) );
            pixz_I = inv_rho_I * ( - ( pop[16])) ;
            piyy_I = inv_rho_I *  (pop[4] + pop[8] + pop[18] - cs2*rho_I);
            piyz_I = inv_rho_I * (- (pop[18]));
            pizz_I = inv_rho_I *  (pop[5] + pop[16] + pop[18] - cs2*rho_I);


            bE = (1.0/24.0)*(T_OMEGA)*(pixx_I + piyy_I + pizz_I 
                        +2.0 * pixy_I + 2.0 * pixz_I - 2.0 * piyz_I);
            dE = 4.0 + 10.0*OMEGA + 4*(OMEGA-3.0)*(-uxVar - uyVar + uzVar) 
                    - 9.0*OMEGA*(uxVar*uxVar + uyVar*uyVar + uzVar*uzVar) + 6.0* OMEGA *
                    ( uxVar * uyVar - uxVar * uzVar - uyVar*uzVar);

            rho = rho_I * bE / dE; //A27
            inv_rho = 1.0/rho;    

            pixx_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pixx_I - 2.0*piyy_I - 2.0 * pizz_I + 6.0*(-pixy_I + pixz_I - piyz_I)) + (2.0/9.0) * (1.0 + 2.0*uxVar - uyVar + uzVar));
            piyy_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * piyy_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(-pixy_I + piyz_I - pixz_I)) + (2.0/9.0) * (1.0 + 2.0*uyVar - uxVar + uzVar));
            pizz_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pizz_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(pixz_I + piyz_I + pixy_I)) + (2.0/9.0) * (1.0 - 2.0*uzVar - uxVar - uyVar));
            pixy_t90 = 9.0 * (inv_rho * ONETHIRD * (-3.0 * pixx_I -3.0 * piyy_I + 3.0* pizz_I + 17.0*pixy_I + pixz_I + piyz_I) - (2.0/9.0) * (1.0 - uyVar - uxVar + uzVar));
            pixz_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * pixx_I +3.0 * pizz_I - 3.0* piyy_I + 17.0*pixz_I + pixy_I - piyz_I) - (2.0/9.0) * (-1.0 - uzVar + uxVar + uyVar));
            piyz_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * piyy_I +3.0 * pizz_I - 3.0* pixx_I + 17.0*piyz_I + pixy_I - pixz_I) - (2.0/9.0) * (-1.0 - uzVar - uyVar + uxVar));

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;    

            break;
        case SOUTH_EAST_BACK:
            // l1 = +1
            // l2 = -1
            // l3 = -1
            uxVar = 0.0;  
            uyVar = 0.0;  
            uzVar = 0.0; 

            //IO: 0/1/4/6/12/13/15
            rho_I = pop[0] + pop[1]  + pop[4] + pop[6] + pop[12] + pop[13] + pop[15];
            inv_rho_I = 1.0 / rho_I;
            pixx_I = inv_rho_I *  (pop[1]  + pop[13] + pop[15] - cs2*rho_I);
            pixy_I = inv_rho_I * ( - (pop[13]));
            pixz_I = inv_rho_I * ( - (pop[15])) ;
            piyy_I = inv_rho_I *  (pop[4] + pop[12] + pop[13]  - cs2*rho_I);
            piyz_I = inv_rho_I * ((pop[12]));
            pizz_I = inv_rho_I *  ( pop[6] + pop[12] + pop[15] - cs2*rho_I);
            

            bE = (1.0/24.0)*(T_OMEGA)*(pixx_I + piyy_I + pizz_I 
                    -2.0 * pixy_I + 2.0 * pixz_I + 2.0 * piyz_I);
            dE = 4.0 + 10.0*OMEGA + 4*(OMEGA-3.0)*(uxVar - uyVar - uzVar) 
                    - 9.0*OMEGA*(uxVar*uxVar + uyVar*uyVar + uzVar*uzVar) + 6.0* OMEGA *
                    ( -uxVar * uyVar - uxVar * uzVar + uyVar*uzVar);

            rho = rho_I * bE / dE; //A27
            inv_rho = 1.0/rho; 

            pixx_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pixx_I - 2.0*piyy_I - 2.0 * pizz_I + 6.0*(pixy_I + pixz_I + piyz_I)) + (2.0/9.0) * (1.0 - 2.0*uxVar - uyVar - uzVar));
            piyy_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * piyy_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(pixy_I - piyz_I - pixz_I)) + (2.0/9.0) * (1.0 + 2.0*uyVar + uxVar - uzVar));
            pizz_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pizz_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(pixz_I - piyz_I - pixy_I)) + (2.0/9.0) * (1.0 + 2.0*uzVar + uxVar - uyVar)); 
            pixy_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * pixx_I +3.0 * piyy_I - 3.0* pizz_I + 17.0*pixy_I - pixz_I + piyz_I) - (2.0/9.0) * (-1.0 + uyVar - uxVar + uzVar));
            pixz_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * pixx_I +3.0 * pizz_I - 3.0* piyy_I + 17.0*pixz_I - pixy_I + piyz_I) - (2.0/9.0) * (-1.0 + uzVar - uxVar + uyVar));
            piyz_t90 = 9.0 * (inv_rho * ONETHIRD * (-3.0 * piyy_I -3.0 * pizz_I + 3.0* pixx_I + 17.0*piyz_I + pixy_I + pixz_I) - (2.0/9.0) * (1.0 - uzVar - uyVar + uxVar));

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho; 
            break;
        case SOUTH_EAST_FRONT:
            // l1 = +1
            // l2 = -1
            // l3 = +1
            uxVar = 0.0;  
            uyVar = 0.0;  
            uzVar = 0.0; 

            //IO: 0/1/4/5/9/13/18
            rho_I = pop[0] + pop[1] + pop[4] + pop[5] + pop[9] + pop[13] + pop[18];
            inv_rho_I = 1.0 / rho_I;
            pixx_I = inv_rho_I *  (pop[1] + pop[9] + pop[13]  - cs2*rho_I);
            pixy_I = inv_rho_I * ( - (pop[13]));
            pixz_I = inv_rho_I * ((pop[9]) ) ;
            piyy_I = inv_rho_I *  (pop[4] + pop[13] + pop[18] - cs2*rho_I);
            piyz_I = inv_rho_I * ( - (pop[18]));
            pizz_I = inv_rho_I *  (pop[5] + pop[9] + pop[18] - cs2*rho_I);


            bE = (1.0/24.0)*(T_OMEGA)*(pixx_I + piyy_I + pizz_I 
                    -2.0 * pixy_I + 2.0 * pixz_I - 2.0 * piyz_I);
            dE = 4.0 + 10.0*OMEGA + 4*(OMEGA-3.0)*(uxVar - uyVar + uzVar) 
                    - 9.0*OMEGA*(uxVar*uxVar + uyVar*uyVar + uzVar*uzVar) + 6.0* OMEGA *
                    ( -uxVar * uyVar + uxVar * uzVar - uyVar*uzVar);

            rho = rho_I * bE / dE; //A27
            inv_rho = 1.0/rho; 

            pixx_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pixx_I - 2.0*piyy_I - 2.0 * pizz_I + 6.0*(pixy_I - pixz_I - piyz_I)) + (2.0/9.0) * (1.0 - 2.0*uxVar - uyVar + uzVar));
            piyy_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * piyy_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(pixy_I + piyz_I + pixz_I)) + (2.0/9.0) * (1.0 + 2.0*uyVar + uxVar + uzVar));
            pizz_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pizz_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(-pixz_I + piyz_I - pixy_I)) + (2.0/9.0) * (1.0 - 2.0*uzVar + uxVar - uyVar));
            pixy_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * pixx_I +3.0 * piyy_I - 3.0* pizz_I + 17.0*pixy_I - pixz_I - piyz_I) - (2.0/9.0) * (-1.0 + uyVar - uxVar + uzVar));
            pixz_t90 = 9.0 * (inv_rho * ONETHIRD * (-3.0 * pixx_I -3.0 * pizz_I + 3.0* piyy_I + 17.0*pixz_I + pixy_I + piyz_I) - (2.0/9.0) * (1.0 + uzVar + uxVar + uyVar));
            piyz_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * piyy_I +3.0 * pizz_I - 3.0* pixx_I + 17.0*piyz_I - pixy_I + pixz_I) - (2.0/9.0) * (-1.0 - uzVar + uyVar + uxVar));

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;    
            break;
        case NORTH_WEST_BACK://TODO: this ones have velocity, need make a way to pass the velocity index
            // l1 = -1
            // l2 = +1
            // l3 = -1
            uxVar = U_MAX; 
            uyVar = 0.0;  
            uzVar = 0.0; 

            //IO: 0/2/3/6/10/14/17
            rho_I = pop[0]  + pop[2] + pop[3] + pop[6] + pop[10] + pop[14] + pop[17];
            inv_rho_I = 1.0 / rho_I;
            pixx_I = inv_rho_I *  (pop[2] + pop[10] + pop[14] - cs2*rho_I);
            pixy_I = inv_rho_I * ( - (pop[14]));
            pixz_I = inv_rho_I * ((pop[9])) ;
            piyy_I = inv_rho_I *  (pop[3] + pop[14] + pop[17] - cs2*rho_I);
            piyz_I = inv_rho_I * ( - (pop[17]));
            pizz_I = inv_rho_I *  (pop[6] + pop[10] + pop[17] - cs2*rho_I);


            bE = (1.0/24.0)*(T_OMEGA)*(pixx_I + piyy_I + pizz_I 
                    +2.0 * pixy_I - 2.0 * pixz_I + 2.0 * piyz_I);
            dE = 4.0 + 10.0*OMEGA + 4*(OMEGA-3.0)*(-uxVar + uyVar + -uzVar) 
                    - 9.0*OMEGA*(uxVar*uxVar + uyVar*uyVar + uzVar*uzVar) + 6.0* OMEGA *
                    ( -uxVar * uyVar + uxVar * uzVar - uyVar*uzVar);

            rho = rho_I * bE / dE; //A27
            inv_rho = 1.0/rho;         
            
            pixx_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pixx_I - 2.0*piyy_I - 2.0 * pizz_I + 6.0*(pixy_I - pixz_I - piyz_I)) + (2.0/9.0) * (1.0 + 2.0*uxVar + uyVar - uzVar));
            piyy_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * piyy_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(pixy_I + piyz_I + pixz_I)) + (2.0/9.0) * (1.0 - 2.0*uyVar - uxVar - uzVar));
            pizz_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pizz_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(-pixz_I + piyz_I - pixy_I)) + (2.0/9.0) * (1.0 + 2.0*uzVar - uxVar + uyVar));
            pixy_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * pixx_I +3.0 * piyy_I - 3.0* pizz_I + 17.0*pixy_I + pixz_I - piyz_I) - (2.0/9.0) * (-1.0 - uyVar + uxVar + uzVar));
            pixz_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * pixx_I -3.0 * pizz_I - 3.0* piyy_I + 17.0*pixz_I + pixy_I + piyz_I) - (2.0/9.0) * (1.0 - uzVar - uxVar + uyVar));
            piyz_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * piyy_I +3.0 * pizz_I - 3.0* pixx_I + 17.0*piyz_I - pixy_I + pixz_I) - (2.0/9.0) * (-1.0 + uzVar - uyVar + uxVar));

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;   
            break;
        case NORTH_WEST_FRONT://TODO: this ones have velocity, need make a way to pass the velocity index
            // l1 = -1
            // l2 = +1
            // l3 = +1
            uxVar = U_MAX; 
            uyVar = 0.0;  
            uzVar = 0.0; 

            //IO: 0/2/3/5/11/14/16
            rho_I = pop[0] + pop[2] + pop[3]  + pop[5] + pop[11] + pop[14] + pop[16];
            inv_rho_I = 1.0 / rho_I;
            pixx_I = inv_rho_I *  (pop[2] + pop[14] + pop[16] - cs2*rho_I);
            pixy_I = inv_rho_I * (- (pop[14]));
            pixz_I = inv_rho_I * (- (pop[16])) ;
            piyy_I = inv_rho_I *  (pop[3] + pop[11] + pop[14] - cs2*rho_I);
            piyz_I = inv_rho_I * ((pop[11]));
            pizz_I = inv_rho_I *  (pop[5] + pop[11] + pop[16] - cs2*rho_I);


            bE = (1.0/24.0)*(T_OMEGA)*(pixx_I + piyy_I + pizz_I 
                    +2.0 * pixy_I + 2.0 * pixz_I - 2.0 * piyz_I);
            dE = 4.0 + 10.0*OMEGA + 4*(OMEGA-3.0)*(-uxVar + uyVar + uzVar) 
                    - 9.0*OMEGA*(uxVar*uxVar + uyVar*uyVar + uzVar*uzVar) + 6.0* OMEGA *
                    ( -uxVar * uyVar + -uxVar * uzVar + uyVar*uzVar);

            rho = rho_I * bE / dE; //A27
            inv_rho = 1.0/rho;        

            pixx_t45 = 4.5 *( inv_rho * ONETHIRD * rho_I * (10.0 * pixx_I - 2.0*piyy_I - 2.0 * pizz_I + 6.0*(pixy_I + pixz_I + piyz_I)) + (2.0/9.0) * (1.0 + 2.0*uxVar + uyVar + uzVar));
            piyy_t45 = 4.5 *( inv_rho * ONETHIRD * rho_I * (10.0 * piyy_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(pixy_I - piyz_I - pixz_I)) + (2.0/9.0) * (1.0 - 2.0*uyVar - uxVar + uzVar));
            pizz_t45 = 4.5 *( inv_rho * ONETHIRD * rho_I * (10.0 * pizz_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(pixz_I - piyz_I - pixy_I)) + (2.0/9.0) * (1.0 - 2.0*uzVar - uxVar + uyVar));
            pixy_t90 = 9.0 *( inv_rho * ONETHIRD * (+3.0 * pixx_I +3.0 * piyy_I - 3.0* pizz_I + 17.0*pixy_I - pixz_I + piyz_I) - (2.0/9.0) * (-1.0 - uyVar + uxVar - uzVar));
            pixz_t90 = 9.0 *( inv_rho * ONETHIRD * (+3.0 * pixx_I +3.0 * pizz_I - 3.0* piyy_I + 17.0*pixz_I - pixy_I + piyz_I) - (2.0/9.0) * (-1.0 - uzVar + uxVar - uyVar));
            piyz_t90 = 9.0 *( inv_rho * ONETHIRD * (-3.0 * piyy_I -3.0 * pizz_I + 3.0* pixx_I + 17.0*piyz_I + pixy_I + pixz_I) - (2.0/9.0) * (1.0 + uzVar + uyVar - uxVar));

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;  
            break;
        case NORTH_EAST_BACK://TODO: this ones have velocity, need make a way to pass the velocity index
            // l1 = +1
            // l2 = +1
            // l3 = -1
            uxVar = U_MAX;  
            uyVar = 0.0;  
            uzVar = 0.0; 

            //IO: 0/1/3/6/7/15/17
            rho_I = pop[0] + pop[1] + pop[3]  + pop[6] + pop[7] + pop[15]  + pop[17];
            inv_rho_I = 1.0 / rho_I;
            pixx_I = inv_rho_I *  (pop[1] + pop[7] + pop[15]  - cs2*rho_I);
            pixy_I = inv_rho_I * ((pop[7] ) );
            pixz_I = inv_rho_I * ( - (pop[15] )) ;
            piyy_I = inv_rho_I *  (pop[3] + pop[7] + pop[17]  - cs2*rho_I);
            piyz_I = inv_rho_I * ( - (pop[17] ));
            pizz_I = inv_rho_I *  (pop[6] + pop[15] + pop[17] - cs2*rho_I);                   


            bE = (1.0/24.0)*(T_OMEGA)*(pixx_I + piyy_I + pizz_I 
                    -2.0 * pixy_I - 2.0 * pixz_I + 2.0 * piyz_I);
            dE = 4.0 + 10.0*OMEGA + 4*(OMEGA-3.0)*(uxVar + uyVar -uzVar) 
                    - 9.0*OMEGA*(uxVar*uxVar + uyVar*uyVar + uzVar*uzVar) + 6.0* OMEGA *
                    ( uxVar * uyVar - uxVar * uzVar - uyVar*uzVar);

            rho = rho_I * bE / dE; //A27
            inv_rho = 1.0/rho;    

            pixx_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pixx_I - 2.0*piyy_I - 2.0 * pizz_I + 6.0*(-pixy_I + pixz_I - piyz_I)) + (2.0/9.0) * (1.0 - 2.0*uxVar + uyVar - uzVar));
            piyy_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * piyy_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(-pixy_I + piyz_I - pixz_I)) + (2.0/9.0) * (1.0 - 2.0*uyVar + uxVar - uzVar));
            pizz_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pizz_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(pixz_I + piyz_I + pixy_I)) + (2.0/9.0) * (1.0 + 2.0*uzVar + uxVar + uyVar));  
            pixy_t90 = 9.0 * (inv_rho * ONETHIRD * (-3.0 * pixx_I -3.0 * piyy_I + 3.0* pizz_I + 17.0*pixy_I + pixz_I + piyz_I) - (2.0/9.0) * (1.0 + uyVar + uxVar - uzVar));
            pixz_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * pixx_I +3.0 * pizz_I - 3.0* piyy_I + 17.0*pixz_I + pixy_I - piyz_I) - (2.0/9.0) * (-1.0 + uzVar - uxVar - uyVar));
            piyz_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * piyy_I +3.0 * pizz_I - 3.0* pixx_I + 17.0*piyz_I + pixy_I - pixz_I) - (2.0/9.0) * (-1.0 + uzVar - uyVar - uxVar));

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho; 
            break;
        case NORTH_EAST_FRONT://TODO: this ones have velocity, need make a way to pass the velocity index
            // l1 = +1
            // l2 = +1
            // l3 = +1
            uxVar = U_MAX;  
            uyVar = 0.0;  
            uzVar = 0.0; 

            //IO: 0/1/3/5/7/9/11
            rho_I = pop[0] + pop[1]  + pop[3]  + pop[5]  + pop[7]  + pop[9]  + pop[11];
            inv_rho_I = 1.0 / rho_I;
            pixx_I = inv_rho_I *  (pop[1] + pop[7] + pop[9] - cs2*rho_I);
            pixy_I = inv_rho_I * ((pop[7]));
            pixz_I = inv_rho_I * ((pop[9])) ;
            piyy_I = inv_rho_I *  (pop[3]  + pop[7]  + pop[11]  - cs2*rho_I);
            piyz_I = inv_rho_I * ((pop[11] ) );
            pizz_I = inv_rho_I *  (pop[5]  + pop[9]  + pop[11] - cs2*rho_I);


            bE = (1.0/24.0)*(T_OMEGA)*(pixx_I + piyy_I + pizz_I 
                    -2.0 * pixy_I - 2.0 * pixz_I - 2.0 * piyz_I);
            dE = 4.0 + 10.0*OMEGA + 4*(OMEGA-3.0)*(uxVar + uyVar + uzVar) 
                    - 9.0*OMEGA*(uxVar*uxVar + uyVar*uyVar + uzVar*uzVar) + 6.0* OMEGA *
                    ( uxVar * uyVar + uxVar * uzVar + uyVar*uzVar);

            rho = rho_I * bE / dE; //A27
            inv_rho = 1.0/rho;            

            pixx_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pixx_I - 2.0*piyy_I - 2.0 * pizz_I + 6.0*(-pixy_I - pixz_I + piyz_I)) + (2.0/9.0) * (1.0 - 2.0*uxVar + uyVar + uzVar));
            piyy_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * piyy_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(-pixy_I - piyz_I + pixz_I)) + (2.0/9.0) * (1.0 - 2.0*uyVar + uxVar + uzVar));
            pizz_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pizz_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(-pixz_I - piyz_I + pixy_I)) + (2.0/9.0) * (1.0 - 2.0*uzVar + uxVar + uyVar));
            pixy_t90 = 9.0 * (inv_rho * ONETHIRD * (-3.0 * pixx_I -3.0 * piyy_I + 3.0* pizz_I + 17.0*pixy_I - pixz_I - piyz_I) - (2.0/9.0) * (1.0 + uyVar + uxVar + uzVar));
            pixz_t90 = 9.0 * (inv_rho * ONETHIRD * (-3.0 * pixx_I -3.0 * pizz_I + 3.0* piyy_I + 17.0*pixz_I - pixy_I - piyz_I) - (2.0/9.0) * (1.0 + uzVar + uxVar + uyVar));
            piyz_t90 = 9.0 * (inv_rho * ONETHIRD * (-3.0 * piyy_I -3.0 * pizz_I + 3.0* pixx_I + 17.0*piyz_I - pixy_I - pixz_I) - (2.0/9.0) * (1.0 + uzVar + uyVar + uxVar));

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;    
            break;






        //edges
        case NORTH_WEST://TODO: this ones have velocity, need make a way to pass the velocity index
        
            //l1 = -1 // l2 = 1 // l3 = 0
            //u1 = ux // u2  = uy // u3 == uz
            uxVar = U_MAX;  
            uyVar = 0.0;  
            uzVar = 0.0; 
            
            //IO: 1/4/7/8/9/12/13/15/18 
            rho_I = pop[0] + pop[2] + pop[3] + pop[5] + pop[6] + pop[10] + pop[11] + pop[14] + pop[16] + pop[17];
            inv_rho_I = 1.0 / rho_I;
            pixx_I = inv_rho_I *  (pop[2] + pop[10]  + pop[14]  + pop[16] - cs2*rho_I);
            pixy_I = inv_rho_I * ( - (pop[14]));
            pixz_I = inv_rho_I * ((pop[10]) - (pop[16])) ;
            piyy_I = inv_rho_I *  (pop[3] + pop[11] + pop[14] + pop[17] - cs2*rho_I);
            piyz_I = inv_rho_I * ((pop[11])-(pop[17]));
            pizz_I = inv_rho_I *  (pop[5] + pop[6] + pop[10] + pop[11] + pop[16] + pop[17] - cs2*rho_I); 

            bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * pixx_I + 8.0 * piyy_I 
                        - 2.0*pizz_I + 19.0*pixy_I); //A28
            dE = 720.0 - 660.0 * (-uxVar + uyVar) + OMEGA * (430.0 - 30.0 * (-uxVar + uyVar) - 414.0*uxVar*uyVar
                        -690.0 * (uxVar*uxVar + uyVar*uyVar) - 69.0 * uzVar*uzVar); //A29

            rho = rho_I * bE / dE; //A27
            inv_rho = 1.0/rho; 

            //                                                                         v this sign may be wrong
            pixx_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pixx_I + piyy_I - 6.0*pizz_I + 34.0*pixy_I) - (2.0/69.0)*(-8.0 - 15.0*uxVar + 8.0*uyVar)); //A30
            piyy_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * piyy_I + pixx_I - 6.0*pizz_I + 34.0*pixy_I) - (2.0/69.0)*(-8.0 + 15.0*uzVar - 8.0*uxVar)); //A30  
            pizz_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 * pixx_I - 9.0*piyy_I + 54.0 * pizz_I - 30.0 * pixy_I) - (4.0/69.0) * (1.0- uxVar + uzVar)); //A31
            pixz_t90 = 9.0 * (inv_rho * 2.0 * pixz_I + ONETHIRD * uzVar); //A33
            piyz_t90 = 9.0 * (inv_rho * 2.0 * piyz_I - ONETHIRD * uzVar); //A33
            pixy_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * (-(-17.0*pixx_I - 17.0*piyy_I + 10.0*pizz_I) + 118.0*pixy_I) - (19.0/69.0)*(-1.0 + uxVar - uzVar)); //A32

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;

            break;
        case NORTH_EAST://TODO: this ones have velocity, need make a way to pass the velocity index
            //l1 = 1 // l2 = 1 // l3 = 0
            //u1 = ux // u2  = uy // u3 == uz 
            uxVar = U_MAX;  
            uyVar = 0.0;  
            uzVar = 0.0; 
            
            //IO: 2/4/8/10/12/13/14/16/18  
            rho_I = pop[0] + pop[1] + pop[3] + pop[5] + pop[6] + pop[7] + pop[9] + pop[11] + pop[15]  + pop[17];
            inv_rho_I = 1.0 / rho_I;
            pixx_I = inv_rho_I *  (pop[1] + pop[7] + pop[9] + pop[15] - cs2*rho_I);
            pixy_I = inv_rho_I * ((pop[7]));
            pixz_I = inv_rho_I * ((pop[9]) - (pop[15])) ;
            piyy_I = inv_rho_I *  (pop[3] + pop[7] + pop[11] + pop[17] - cs2*rho_I);
            piyz_I = inv_rho_I * ((pop[11])-(pop[17]));
            pizz_I = inv_rho_I *  (pop[5] + pop[6] + pop[9] + pop[11] + pop[15] + pop[17] - cs2*rho_I);

            bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * pixx_I + 8.0 * piyy_I 
                        - 2.0*pizz_I - 19.0*pixy_I); //A28
            dE = 720.0 - 660.0 * (uxVar + uyVar) + OMEGA * (430.0 - 30.0 * (uxVar + uyVar) + 414.0*uxVar*uyVar
                        -690.0 * (uxVar*uxVar + uyVar*uyVar) - 69.0 * uzVar*uzVar); //A29

            rho = rho_I * bE / dE; //A27
            inv_rho = 1.0/rho; 

            //                                                                         v this sign may be wrong
            pixx_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pixx_I + piyy_I - 6.0*pizz_I - 34.0*pixy_I) - (2.0/69.0)*(-8.0 + 15.0*uxVar + 8.0*uyVar)); //A30
            piyy_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * piyy_I + pixx_I - 6.0*pizz_I - 34.0*pixy_I) - (2.0/69.0)*(-8.0 + 15.0*uzVar + 8.0*uxVar));//A30  
            pizz_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 * pixx_I - 9.0*piyy_I + 54.0 * pizz_I + 30.0 * pixy_I) - (4.0/69.0) * (1.0+ uxVar + uzVar)); //A31
            pixz_t90 = 9.0 * (inv_rho * 2.0 * pixz_I - ONETHIRD * uzVar); //A33
            piyz_t90 = 9.0 * (inv_rho * 2.0 * piyz_I - ONETHIRD * uzVar); //A33
            pixy_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * ((-17.0*pixx_I - 17.0*piyy_I + 10.0*pizz_I) + 118.0*pixy_I) - (19.0/69.0)*(1.0 + uxVar + uzVar)); //A32

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;  
            break;
        case NORTH_FRONT://TODO: this ones have velocity, need make a way to pass the velocity index
            //l1 = 1 // l2 = 1 // l3 = 0
            //u1 = uy // u2  = uz // u3 == ux
            uxVar = U_MAX;  
            uyVar = 0.0;  
            uzVar = 0.0; 
            
            //IO: 4/6/8/10/12/13/15/17/18 
            rho_I = pop[0] + pop[1] + pop[2] + pop[3] + pop[5] + pop[7] + pop[9] + pop[11] + pop[14] + pop[16];
            inv_rho_I = 1.0 / rho_I;
            pixx_I = inv_rho_I *  (pop[1] + pop[2] + pop[7] + pop[9] + pop[14] + pop[16] - cs2*rho_I);
            pixy_I = inv_rho_I * ((pop[7]) - ( pop[14]));
            pixz_I = inv_rho_I * ((pop[9] ) - ( pop[16])) ;
            piyy_I = inv_rho_I *  (pop[3] + pop[7] + pop[11] + pop[14] - cs2*rho_I);
            piyz_I = inv_rho_I * ((pop[11]));
            pizz_I = inv_rho_I *  (pop[5] + pop[9] + pop[11] + pop[16] - cs2*rho_I);

            bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * piyy_I + 8.0 * pizz_I 
                        - 2.0*pixx_I - 19.0*piyz_I); //A28
            dE = 720.0 - 660.0 * (uyVar + uzVar) + OMEGA * (430.0 - 30.0 * (uyVar + uzVar) + 414.0*uxVar*uzVar
                        -690.0 * (uyVar*uyVar + uzVar*uzVar) - 69.0 * uxVar*uxVar); //A29

            rho = rho_I * bE / dE; //A27
            inv_rho = 1.0/rho;


            piyy_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * piyy_I + pizz_I - 6.0*pixx_I - 34.0*piyz_I) - (2.0/69.0)*(-8.0 + 15.0*uyVar + 8.0*uzVar)); //A30  
            pizz_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pizz_I + piyy_I - 6.0*pixx_I - 34.0*piyz_I) - (2.0/69.0)*(-8.0 + 15.0*uzVar + 8.0*uyVar)); //A30
            pixx_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 * piyy_I - 9.0*pizz_I + 54.0 * pixx_I + 30.0 * piyz_I) - (4.0/69.0) * (1.0 + uyVar + uzVar)); //A31
            pixy_t90 = 9.0 * (inv_rho * 2.0 * pixz_I - ONETHIRD * uxVar); //A33
            pixz_t90 = 9.0 * (inv_rho * 2.0 * pixz_I - ONETHIRD * uxVar); //A33
            piyz_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * ((-17.0*piyy_I - 17.0*pizz_I + 10.0*pixx_I) + 118.0*pixy_I) - (19.0/69.0)*(1.0 + uyVar + uzVar)); //A32

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;
            break;
        case NORTH_BACK://TODO: this ones have velocity, need make a way to pass the velocity index
            //l1 = 1 // l2 = -1 // l3 = 0
            //u1 = uy // u2  = uz // u3 == ux
            uxVar = U_MAX;  
            uyVar = 0.0;  
            uzVar = 0.0; 
            
            //IO:  4/5/8/9/11/12/13/16/18
            rho_I = pop[0] + pop[1] + pop[2] + pop[3] + pop[6] + pop[7] + pop[10] + pop[14] + pop[15] + pop[17];
            inv_rho_I = 1.0 / rho_I;
            pixx_I = inv_rho_I *  (pop[1] + pop[2] + pop[7] + pop[10] + pop[14] + pop[15] - cs2*rho_I);
            pixy_I = inv_rho_I * ((pop[7]) - (pop[14]));
            pixz_I = inv_rho_I * ((pop[10]) - (pop[15])) ;
            piyy_I = inv_rho_I *  (pop[3] + pop[7] + pop[14] + pop[17] - cs2*rho_I);
            piyz_I = inv_rho_I * (- (pop[17]));
            pizz_I = inv_rho_I *  (pop[6] + pop[10] + pop[15] + pop[17] - cs2*rho_I); 

            bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * piyy_I + 8.0 * pizz_I 
                        - 2.0*pixx_I + 19.0*piyz_I); //A28
            dE = 720.0 - 660.0 * (uyVar - uzVar) + OMEGA * (430.0 - 30.0 * (uyVar - uzVar) - 414.0*uxVar*uzVar
                        -690.0 * (uyVar*uyVar + uzVar*uzVar) - 69.0 * uxVar*uxVar); //A29

            rho = rho_I * bE / dE; //A27
            inv_rho = 1.0/rho;

            piyy_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * piyy_I + pizz_I - 6.0*pixx_I + 34.0*piyz_I) - (2.0/69.0)*(-8.0 + 15.0*uyVar - 8.0*uzVar)); //A30  
            pizz_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pizz_I + piyy_I - 6.0*pixx_I + 34.0*piyz_I) - (2.0/69.0)*(-8.0 - 15.0*uzVar + 8.0*uyVar)); //A30
            pixx_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 * piyy_I - 9.0*pizz_I + 54.0 * pixx_I - 30.0 * piyz_I) - (4.0/69.0) * (1.0 + uyVar - uzVar)); //A31
            pixy_t90 = 9.0 * (inv_rho * 2.0 * pixz_I - ONETHIRD * uxVar); //A33
            pixz_t90 = 9.0 * (inv_rho * 2.0 * pixz_I + ONETHIRD * uxVar); //A33
            piyz_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * (-(-17.0*piyy_I - 17.0*pizz_I + 10.0*pixx_I) + 118.0*pixy_I) - (19.0/69.0)*(-1.0 - uyVar + uzVar)); //A32

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho; 
            break;
        case SOUTH_EAST:
            //l1 = 1 // l2 = -1 // l3 = 0
            //u1 = ux // u2  = uy // u3 == uz

            uxVar = 0.0;  
            uyVar = 0.0;  
            uzVar = 0.0; 
            
            //IO: 2/3/7/8/10/11/14/16/17 
            rho_I = pop[0] + pop[1] + pop[4] + pop[5] + pop[6] + pop[9] + pop[12] + pop[13] + pop[15] + pop[18];
            inv_rho_I = 1.0 / rho_I;
            pixx_I = inv_rho_I *  (pop[1] + pop[9] + pop[13] + pop[15] - cs2*rho_I);
            pixy_I = inv_rho_I * ( - (pop[13]));
            pixz_I = inv_rho_I * ((pop[9]) - (pop[15])) ;
            piyy_I = inv_rho_I *  ( pop[4] + pop[12] + pop[13] + pop[18] - cs2*rho_I);
            piyz_I = inv_rho_I * ((pop[12]) - (pop[18]));
            pizz_I = inv_rho_I *  (pop[5] + pop[6] + pop[9] + pop[12] + pop[15] + pop[18] - cs2*rho_I);

            bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * pixx_I + 8.0 * piyy_I 
                        - 2.0*pizz_I + 19.0*pixy_I); //A28
            dE = 720.0 - 660.0 * (uxVar - uyVar) + OMEGA * (430.0 - 30.0 * (uxVar - uyVar) - 414.0*uxVar*uyVar
                        -690.0 * (uxVar*uxVar + uyVar*uyVar) - 69.0 * uzVar*uzVar); //A29

            rho = rho_I * bE / dE; //A27
            inv_rho = 1.0/rho;
            
            //                                                                         v this sign may be wrong
            pixx_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pixx_I + piyy_I - 6.0*pizz_I + 34.0*pixy_I) - (2.0/69.0)*(-8.0 + 15.0*uxVar - 8.0*uyVar)); //A30
            piyy_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * piyy_I + pixx_I - 6.0*pizz_I + 34.0*pixy_I) - (2.0/69.0)*(-8.0 + 15.0*uzVar - 8.0*uxVar));//A30  
            pizz_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 * pixx_I - 9.0*piyy_I + 54.0 * pizz_I + 30.0 * pixy_I) - (4.0/69.0) * (-1.0 + uxVar - uzVar)); //A31
            pixz_t90 = 9.0 * (inv_rho * 2.0 * pixz_I - ONETHIRD * uzVar); //A33
            piyz_t90 = 9.0 * (inv_rho * 2.0 * piyz_I + ONETHIRD * uzVar); //A33
            pixy_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * (-(-17.0*pixx_I - 17.0*piyy_I + 10.0*pizz_I) + 118.0*pixy_I) - (19.0/69.0)*(-1.0 - uxVar + uzVar)); //A32

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho; 
            break;
        case SOUTH_WEST:
            //l1 = -1 // l2 = -1 // l3 = 0
            //u1 = ux // u2  = uy // u3 == uz
            uxVar = 0.0;  
            uyVar = 0.0;  
            uzVar = 0.0; 
            
            //IO: 1/3/7/9/11/13/14/15/17    
            rho_I = pop[0] + pop[2] + pop[4] + pop[5] + pop[6] + pop[8] + pop[10] + pop[12] + pop[16] + pop[18];
            inv_rho_I = 1.0 / rho_I;
            pixx_I = inv_rho_I *  (pop[2] + pop[8] + pop[10] + pop[16] - cs2*rho_I);
            pixy_I = inv_rho_I * ((pop[ 8]));
            pixz_I = inv_rho_I * ((pop[10]) - (pop[16])) ;
            piyy_I = inv_rho_I *  (pop[4] + pop[8] + pop[12] + pop[18] - cs2*rho_I);
            piyz_I = inv_rho_I * ((pop[12]) - (pop[18]));
            pizz_I = inv_rho_I *  (pop[5] + pop[6] + pop[10] + pop[12] + pop[15] + pop[18] - cs2*rho_I);

            bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * pixx_I + 8.0 * piyy_I 
                        - 2.0*pizz_I - 19.0*pixy_I); //A28
            dE = 720.0 - 660.0 * (-uxVar - uyVar) + OMEGA * (430.0 - 30.0 * (-uxVar - uyVar) + 414.0*uxVar*uyVar
                        -690.0 * (uxVar*uxVar + uyVar*uyVar) - 69.0 * uzVar*uzVar); //A29

            rho = rho_I * bE / dE; //A27
            inv_rho = 1.0/rho; 

            //                                                                         v this sign may be wrong
            pixx_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pixx_I + piyy_I - 6.0*pizz_I - 34.0*pixy_I) - (2.0/69.0)*(-8.0 - 15.0*uxVar - 8.0*uyVar)); //A30
            piyy_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * piyy_I + pixx_I - 6.0*pizz_I - 34.0*pixy_I) - (2.0/69.0)*(-8.0 - 15.0*uzVar - 8.0*uxVar)); //A30  
            pizz_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 * pixx_I - 9.0*piyy_I + 54.0 * pizz_I + 30.0 * pixy_I) - (4.0/69.0) * (1.0- uxVar - uzVar)); //A31
            pixz_t90 = 9.0 * (inv_rho * 2.0 * pixz_I + ONETHIRD * uzVar); //A33
            piyz_t90 = 9.0 * (inv_rho * 2.0 * piyz_I + ONETHIRD * uzVar); //A33
            pixy_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * ((-17.0*pixx_I - 17.0*piyy_I + 10.0*pizz_I) + 118.0*pixy_I) - (19.0/69.0)*(1.0 - uxVar - uzVar)); //A32

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;   
            break;
        case SOUTH_FRONT:
            //l1 = -1 // l2 = 1 // l3 = 0
            //u1 = uy // u2  = uz // u3 == ux

            uxVar = 0.0;  
            uyVar = 0.0;  
            uzVar = 0.0; 
            
            //IO: 3/6/7/10/11/12/14/15/17
            rho_I = pop[0] + pop[1] + pop[2] + pop[4] + pop[5] + pop[8] + pop[9] + pop[13] + pop[16] + pop[18];
            inv_rho_I = 1.0 / rho_I;
            pixx_I = inv_rho_I *  (pop[1] + pop[2] + pop[8] + pop[9] + pop[13] + pop[16] - cs2*rho_I);
            pixy_I = inv_rho_I * ((pop[8]) - (pop[13]));
            pixz_I = inv_rho_I * ((pop[9]) - (pop[16])) ;
            piyy_I = inv_rho_I *  (pop[4] + pop[8] + pop[13] + pop[18] - cs2*rho_I);
            piyz_I = inv_rho_I * ( - ( pop[18]));
            pizz_I = inv_rho_I *  (pop[5]  + pop[9] + pop[16] + pop[18] - cs2*rho_I);

            bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * piyy_I + 8.0 * pizz_I 
                        - 2.0*pixx_I + 19.0*piyz_I); //A28
            dE = 720.0 - 660.0 * (-uyVar + uzVar) + OMEGA * (430.0 - 30.0 * (-uyVar + uzVar) - 414.0*uxVar*uzVar
                        -690.0 * (uyVar*uyVar + uzVar*uzVar) - 69.0 * uxVar*uxVar); //A29

            rho = rho_I * bE / dE; //A27
            inv_rho = 1.0/rho;

            piyy_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * piyy_I + pizz_I - 6.0*pixx_I + 34.0*piyz_I) - (2.0/69.0)*(-8.0 - 15.0*uyVar + 8.0*uzVar));//A30  
            pizz_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pizz_I + piyy_I - 6.0*pixx_I + 34.0*piyz_I) - (2.0/69.0)*(-8.0 + 15.0*uzVar - 8.0*uyVar)); //A30
            pixx_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 * piyy_I - 9.0*pizz_I + 54.0 * pixx_I - 30.0 * piyz_I) - (4.0/69.0) * (1.0 - uyVar + uzVar)); //A31
            pixy_t90 = 9.0 * (inv_rho * 2.0 * pixz_I + ONETHIRD * uxVar); //A33
            pixz_t90 = 9.0 * (inv_rho * 2.0 * pixz_I - ONETHIRD * uxVar); //A33
            piyz_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * (-(-17.0*piyy_I - 17.0*pizz_I + 10.0*pixx_I) + 118.0*pixy_I) - (19.0/69.0)*(-1.0 + uyVar - uzVar)); //A32

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho; 
            break;
        case SOUTH_BACK:
            //l1 = -1 // l2 = -1 // l3 = 0
            //u1 = uy // u2  = uz // u3 == ux

            uxVar = 0.0;  
            uyVar = 0.0;  
            uzVar = 0.0; 
            
            //IO: 3/5/7/9/11/14/16/17/18
            rho_I = pop[0] + pop[1] + pop[2] + pop[4] + pop[6] + pop[8] + pop[10] + pop[12] + pop[13] + pop[15];
            inv_rho_I = 1.0 / rho_I;
            pixx_I = inv_rho_I *  (pop[1] + pop[2] + pop[8] + pop[10] + pop[13] + pop[15] - cs2*rho_I);
            pixy_I = inv_rho_I * ((pop[8]) - (pop[13]));
            pixz_I = inv_rho_I * ((pop[10]) - (pop[15])) ;
            piyy_I = inv_rho_I *  (pop[4] + pop[8] + pop[12] + pop[13] - cs2*rho_I);
            piyz_I = inv_rho_I * ((pop[12]));
            pizz_I = inv_rho_I *  (pop[6] + pop[10] + pop[12] + pop[15] - cs2*rho_I); 

            bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * piyy_I + 8.0 * pizz_I 
                        - 2.0*pixx_I - 19.0*piyz_I); //A28
            dE = 720.0 - 660.0 * (-uyVar - uzVar) + OMEGA * (430.0 - 30.0 * (-uyVar - uzVar) + 414.0*uxVar*uzVar
                        -690.0 * (uyVar*uyVar + uzVar*uzVar) - 69.0 * uxVar*uxVar); //A29

            rho = rho_I * bE / dE; //A27
            inv_rho = 1.0/rho;


            piyy_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * piyy_I + pizz_I - 6.0*pixx_I - 34.0*piyz_I) - (2.0/69.0)*(-8.0 - 15.0*uyVar - 8.0*uzVar));//A30  
            pizz_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pizz_I + piyy_I - 6.0*pixx_I - 34.0*piyz_I) - (2.0/69.0)*(-8.0 - 15.0*uzVar - 8.0*uyVar)); //A30
            pixx_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 * piyy_I - 9.0*pizz_I + 54.0 * pixx_I + 30.0 * piyz_I) - (4.0/69.0) * (1.0 - uyVar - uzVar)); //A31
            pixy_t90 = 9.0 * (inv_rho * 2.0 * pixz_I + ONETHIRD * uxVar); //A33
            pixz_t90 = 9.0 * (inv_rho * 2.0 * pixz_I + ONETHIRD * uxVar); //A33
            piyz_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * ((-17.0*piyy_I - 17.0*pizz_I + 10.0*pixx_I) + 118.0*pixy_I) - (19.0/69.0)*(1.0 - uyVar - uzVar)); //A32

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;  
            break;
        case WEST_FRONT:
            //l1 = -1 // l2 = 1 // l3 = 0
            //u1 = ux // u2  = uz // u3 == uy

             uxVar = 0.0;  
            uyVar = 0.0;  
            uzVar = 0.0; 
            
            //IO: 1/6/7/9/10/12/13/15/17
            rho_I = pop[0] + pop[2] + pop[3] + pop[4] + pop[5] + pop[8] + pop[11] + pop[14] + pop[16] + pop[18];
            inv_rho_I = 1.0 / rho_I;
            pixx_I = inv_rho_I *  (pop[2] + pop[8] + pop[14] + pop[16] - cs2*rho_I);
            pixy_I = inv_rho_I * ((pop[ 8]) - (pop[14]));
            pixz_I = inv_rho_I * (- (pop[16])) ;
            piyy_I = inv_rho_I *  (pop[3] + pop[4] + pop[8] + pop[11] + pop[14] + pop[18] - cs2*rho_I);
            piyz_I = inv_rho_I * ((pop[11])-(pop[18]));
            pizz_I = inv_rho_I *  (pop[5] + pop[11]+ pop[16] + pop[18] - cs2*rho_I);

            bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * pixx_I + 8.0 * pizz_I 
                        - 2.0*piyy_I + 19.0*pixz_I); //A28
            dE = 720.0 - 660.0 * (uxVar - uzVar) + OMEGA * (430.0 + 30.0 * (uxVar + uzVar) - 414.0*uxVar*uzVar
                        -690.0 * (uxVar*uxVar + uzVar*uzVar) - 69.0 * uyVar*uyVar); //A29

            rho = rho_I * bE / dE; //A27
            inv_rho = 1.0/rho; 

            //                                                                         v this sign may be wrong
            pixx_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pixx_I + pizz_I - 6.0*piyy_I + 34.0*pixz_I) - (2.0/69.0)*(-8.0-15.0*uxVar+8.0*uzVar)); //A30
            pizz_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pizz_I + pixx_I - 6.0*piyy_I + 34.0*pixz_I) - (2.0/69.0)*(-8.0+15.0*uzVar-8.0*uxVar));//A30  
            piyy_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 *pixx_I - 9.0*pizz_I + 54.0 * piyy_I - 30.0 * pixz_I) - (4.0/69.0) * (1.0- uxVar + uzVar)); //A31
            pixy_t90 = 9.0 * (inv_rho * 2.0 * pixy_I + ONETHIRD * uyVar); //A33
            piyz_t90 = 9.0 * (inv_rho * 2.0 * piyz_I - ONETHIRD * uyVar); //A33
            pixz_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * (-(-17.0*pixx_I - 17.0*pizz_I + 10.0*piyy_I) + 118.0*pixz_I) - (19.0/69.0)*(-1.0 - uxVar + uzVar)); //A32

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;    
            break;
        case WEST_BACK:
            //l1 = -1 // l2 = -1 // l3 = 0
            //u1 = ux // u2  = uz // u3 == uy

            uxVar = 0.0;  
            uyVar = 0.0;  
            uzVar = 0.0;  

            //IO: 1/5/7/9/11/13/15/16/18
            rho_I = pop[0] + pop[2] + pop[3] + pop[4] + pop[6] + pop[8] + pop[10] + pop[12] + pop[14] + pop[17];
            inv_rho_I = 1.0 / rho_I;
            pixx_I = inv_rho_I *  (pop[2] + pop[8] + pop[10] + pop[14] - cs2*rho_I);
            pixy_I = inv_rho_I * ((pop[ 8]) - (pop[14]));
            pixz_I = inv_rho_I * ((pop[10]));
            piyy_I = inv_rho_I *  (pop[3] + pop[4] + pop[8] + pop[12] + pop[14] + pop[17] - cs2*rho_I);
            piyz_I = inv_rho_I * ((pop[12])-(pop[17]));
            pizz_I = inv_rho_I *  (pop[6] + pop[10] + pop[12] + pop[17] - cs2*rho_I);

            bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * pixx_I + 8.0 * pizz_I 
                        - 2.0*piyy_I - 19.0*pixz_I); //A28
            dE = 720.0 - 660.0 * (-uxVar - uzVar) + OMEGA * (430.0 + 30.0 * (uxVar + uzVar) + 414.0*uxVar*uzVar
                        -690.0 * (uxVar*uxVar + uzVar*uzVar) - 69.0 * uyVar*uyVar); //A29

            rho = rho_I * bE / dE; //A27
            inv_rho = 1.0/rho;

            //                                                                         v this sign may be wrong
            pixx_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pixx_I + pizz_I - 6.0*piyy_I - 34.0*pixz_I) - (2.0/69.0)*(-8.0-15.0*uxVar-8.0*uzVar)); //A30
            pizz_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pizz_I + pixx_I - 6.0*piyy_I - 34.0*pixz_I) - (2.0/69.0)*(-8.0-15.0*uzVar-8.0*uxVar)); //A30
            piyy_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 *pixx_I - 9.0*pizz_I + 54.0 * piyy_I + 30.0 * pixz_I) - (4.0/69.0) * (1.0- uxVar - uzVar)); //A31
            pixy_t90 = 9.0 * (inv_rho * 2.0 * pixy_I + ONETHIRD * uyVar); //A33
            piyz_t90 = 9.0 * (inv_rho * 2.0 * piyz_I + ONETHIRD * uyVar); //A33
            pixz_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * ((-17.0*pixx_I - 17.0*pizz_I + 10.0*piyy_I) + 118.0*pixz_I) - (19.0/69.0)*(1.0 - uxVar - uzVar)); //A32

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;
            break;
        case EAST_FRONT:
            //l1 = 1 // l2 = 1 // l3 = 0
            //u1 = ux // u2  = uz // u3 == uy
            uxVar = 0.0;  
            uyVar = 0.0;  
            uzVar = 0.0; 
            
            //IO:2/6/8/10/12/14/15/16/17
            rho_I = pop[0] + pop[1] + pop[3] + pop[4] + pop[5] + pop[7] + pop[9] + pop[11]  + pop[13] + pop[18];
            inv_rho_I = 1.0 / rho_I;
            pixx_I = inv_rho_I *  (pop[1] + pop[7] + pop[9] + pop[13] - cs2*rho_I);
            pixy_I = inv_rho_I * ((pop[7]) - (pop[13]));
            pixz_I = inv_rho_I * ((pop[9])) ;
            piyy_I = inv_rho_I *  (pop[3] + pop[4] + pop[7] + pop[11] + pop[13] + pop[18] - cs2*rho_I);
            piyz_I = inv_rho_I * ((pop[11])-(pop[18]));
            pizz_I = inv_rho_I *  (pop[5] + pop[9] + pop[11] + pop[18] - cs2*rho_I);  
                
            bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * pixx_I + 8.0 * pizz_I 
                        - 2.0*piyy_I - 19.0*pixz_I); //A28  
            dE = 720.0 - 660.0 * (uxVar + uzVar) + OMEGA * (430.0 + 30.0 * (uxVar + uzVar) + 414.0*uxVar*uzVar
                        -690.0 * (uxVar*uxVar + uzVar*uzVar) - 69.0 * uyVar*uyVar); //A29

            rho = rho_I * bE / dE; //A27
            inv_rho = 1.0/rho; 
            //                                                                         v this sign may be wrong
            pixx_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pixx_I + pizz_I - 6.0*piyy_I - 34.0*pixz_I) - (2.0/69.0)*(-8.0+15.0*uxVar+8.0*uzVar)); //A30
            pizz_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pizz_I + pixx_I - 6.0*piyy_I - 34.0*pixz_I) - (2.0/69.0)*(-8.0+15.0*uzVar+8.0*uxVar)); //)A30    
            piyy_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 *pixx_I - 9.0*pizz_I + 54.0 * piyy_I + 30.0 * pixz_I) - (4.0/69.0) * (1.0+ uxVar + uzVar)); //A31 
            pixy_t90 = 9.0 * (inv_rho * 2.0 * pixy_I - ONETHIRD * uyVar); //A33
            piyz_t90 = 9.0 * (inv_rho * 2.0 * piyz_I - ONETHIRD * uyVar); //A33 
            pixz_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * ((-17.0*pixx_I - 17.0*pizz_I + 10.0*piyy_I) + 118.0*pixz_I) - (19.0/69.0)*(1.0 + uxVar + uzVar)); //A32

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;   
            break;
        case EAST_BACK:
            //l1 = 1 // l2 = -1 // l3 = 0
            //u1 = ux // u2  = uz // u3 == uy
            uxVar = 0.0;  
            uyVar = 0.0;  
            uzVar = 0.0; 
            
            //IO:2/5/8/9/10/11/14/16/18
            rho_I = pop[0] + pop[1] + pop[3] + pop[4] + pop[6] + pop[7] + pop[12] + pop[13]  + pop[15]  + pop[17];
            inv_rho_I = 1.0 / rho_I;
            pixx_I = inv_rho_I *  (pop[1] + pop[7] + pop[13] + pop[15] - cs2*rho_I);
            pixy_I = inv_rho_I * ((pop[7]) - (pop[13]));
            pixz_I = inv_rho_I * (- (pop[15])) ;
            piyy_I = inv_rho_I * (pop[3] + pop[4] + pop[7] + pop[12] + pop[13] + pop[17] - cs2*rho_I);
            piyz_I = inv_rho_I * ((pop[12])-(pop[17]));
            pizz_I = inv_rho_I * (pop[6] + pop[12] + pop[15] + pop[17] - cs2*rho_I);

            bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * pixx_I + 8.0 * pizz_I 
                        - 2.0*piyy_I + 19.0*pixz_I); //A28
            dE = 720.0 - 660.0 * (uxVar - uzVar) + OMEGA * (430.0 + 30.0 * (uxVar + uzVar) - 414.0*uxVar*uzVar
                        -690.0 * (uxVar*uxVar + uzVar*uzVar) - 69.0 * uyVar*uyVar); //A29

            rho = rho_I * bE / dE; //A27
            inv_rho = 1.0/rho;            

            //                                                                         v this sign may be wrong
            pixx_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pixx_I + pizz_I - 6.0*piyy_I + 34.0*pixz_I) - (2.0/69.0)*(-8.0+15.0*uxVar-8.0*uzVar)); //A30
            pizz_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pizz_I + pixx_I - 6.0*piyy_I + 34.0*pixz_I) - (2.0/69.0)*(-8.0-15.0*uzVar+8.0*uxVar)); //A30
            piyy_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 *pixx_I - 9.0*pizz_I + 54.0 * piyy_I - 30.0 * pixz_I) - (4.0/69.0) * (1.0+ uxVar - uzVar)); //A31 
            pixy_t90 = 9.0 * (inv_rho * 2.0 * pixy_I - ONETHIRD * uyVar); //A33
            piyz_t90 = 9.0 * (inv_rho * 2.0 * piyz_I + ONETHIRD * uyVar); //A33   
            pixz_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * ((-17.0*pixx_I - 17.0*pizz_I + 10.0*piyy_I) + 118.0*pixz_I) - (19.0/69.0)*(1.0 + uxVar - uzVar)); //A32

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;  
            break;

        // face
        case SOUTH:
            //l1 = -1 // l2 = 0 // l3 = 0
            //u1 = uy // u2  = ux // u3 == uz
            uxVar = 0.0;  
            uyVar = 0.0;  
            uzVar = 0.0;  

            //IO: 4/8/12/13/18


            rho_I = pop[0] + pop[1] + pop[2] + pop[3] + pop[5] + pop[6] + pop[7] + pop[9] + pop[10] + pop[11] + pop[14] + pop[15] + pop[16] + pop[17]; 
            inv_rho_I = 1.0 / rho_I; 
            pixx_I = inv_rho_I *   (pop[1] + pop[2] + pop[7] + pop[9] + pop[10] + pop[14] + pop[15] + pop[16] -  cs2*rho_I);
            pixy_I = inv_rho_I *  ((pop[7]) - (pop[14]));
            pixz_I = inv_rho_I *  ((pop[9] + pop[10]) - (pop[15] + pop[16]));
            piyy_I = inv_rho_I *   (pop[3] +pop[7] + pop[11] + pop[14] + pop[17]  - cs2*rho_I);
            piyz_I = inv_rho_I *  ((pop[11])-(pop[17]));
            pizz_I = inv_rho_I *   (pop[5] + pop[6] + pop[9] + pop[10] + pop[11] + pop[15] + pop[16] + pop[17]  - cs2*rho_I);

            rho = rho_I * (9.0 * T_OMEGA * (piyy_I) + 12.0) / (OMEGA * (1.0 - 6.0 * uyVar * uyVar) + 3.0 * uyVar * OMEGA_P1 + 9.0); //A34
            inv_rho = 1.0/rho;

            piyy_t45 = 4.5 * inv_rho * (1.5 * rho_I * piyy_I + rho * (ONESIXTH + 0.5 * uyVar)); //A35
            pixx_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * pixx_I - pizz_I); //A36
            pizz_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * pizz_I - pixx_I); //A39
            pixy_t90 = 9.0 * inv_rho * (2.0 * rho_I * pixy_I + ONETHIRD*rho*uxVar); //A37
            piyz_t90 = 9.0 * inv_rho * (2.0 * rho_I * piyz_I + ONETHIRD*rho*uzVar); //A40      
            pixz_t90 = 9.0 * inv_rho * rho_I * pixz_I; //A38

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;

            break;
        case NORTH: //TODO: this ones have velocity, need make a way to pass the velocity index
            //l1 = 1 // l2 = 0 // l3 = 0
            //u1 = uy // u2  = ux // u3 == uz
            uxVar = U_MAX;  
            uyVar = 0.0;  
            uzVar = 0.0;  

            //IO: 3/7/11/14/17
            rho_I = pop[0] + pop[1] + pop[2] + pop[4] + pop[5] + pop[6] + pop[8] + pop[9] + pop[10] + pop[12] + pop[13] + pop[15] + pop[16] + pop[18];
            inv_rho_I = 1.0 / rho_I;

            pixx_I = inv_rho_I *  (pop[1] + pop[2] + pop[8] + pop[9] + pop[10] + pop[13] + pop[15] + pop[16] -  cs2*rho_I);
            pixy_I = inv_rho_I * (( pop[ 8]) - (pop[13] ));
            pixz_I = inv_rho_I * ((pop[9] + pop[10]) - (pop[15] + pop[16]));
            piyy_I = inv_rho_I *  ( pop[4]  + pop[8]+ pop[12] + pop[13] + pop[18] - cs2*rho_I);
            piyz_I = inv_rho_I * ((pop[12])-(pop[18]));
            pizz_I = inv_rho_I *  (pop[5] + pop[6] + pop[9] + pop[10] + pop[12] + pop[15] + pop[16]+ pop[18] - cs2*rho_I);

            rho = rho_I * (9.0 * T_OMEGA * (piyy_I) + 12.0) / (OMEGA * (1.0 - 6.0 * uyVar * uyVar) - 3.0 * uyVar * OMEGA_P1 + 9.0); //A34
            inv_rho = 1.0/rho;

            piyy_t45 = 4.5 * inv_rho * (1.5 * rho_I * piyy_I + rho * (ONESIXTH - 0.5 * uyVar)); //A35
            pixx_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * pixx_I - pizz_I); //A36
            pizz_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * pizz_I - pixx_I); //A39
            pixy_t90 = 9.0 * inv_rho * (2.0 * rho_I * pixy_I - ONETHIRD*rho*uxVar); //A37
            piyz_t90 = 9.0 * inv_rho * (2.0 * rho_I * piyz_I - ONETHIRD*rho*uzVar); //A40       
            pixz_t90 = 9.0 * inv_rho * rho_I * pixz_I; //A38

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;

            break;
        case EAST:
            //l1 = 1 // l2 = 0 // l3 = 0
            //u1 = ux // u2  = uy // u3 == uz
            uxVar = 0.0;  
            uyVar = 0.0;  
            uzVar = 0.0;  

            //2/8//10/14/16
            rho_I = pop[0] + pop[1] + pop[3] + pop[4] + pop[5] + pop[6] + pop[7] + pop[9] + pop[11] + pop[12] + pop[13] + pop[15] + pop[17] + pop[18];
            inv_rho_I = 1.0 / rho_I;

            pixx_I = inv_rho_I *  (pop[1] + pop[7] + pop[9] + pop[13] + pop[15]  - cs2* rho_I) ;
            pixy_I = inv_rho_I * ((pop[7] ) - (pop[13] ));
            pixz_I = inv_rho_I * ((pop[9] ) - (pop[15] ));
            piyy_I = inv_rho_I *  (pop[3] + pop[4] + pop[7] + pop[11] + pop[12] + pop[13] + pop[17] + pop[18] - cs2* rho_I);
            piyz_I = inv_rho_I * ((pop[11]+pop[12])-(pop[17]+pop[18]));
            pizz_I = inv_rho_I *  (pop[5] + pop[6] + pop[9] + pop[11] + pop[12] + pop[15] + pop[17] + pop[18] - cs2* rho_I);


            rho = rho_I * ( 9.0 * T_OMEGA * (pixx_I) + 12.0) / (OMEGA * (1.0 - 6.0 * uxVar * uxVar) - 3.0 * uyVar * OMEGA_P1 + 9.0); //A34
            inv_rho = 1.0/rho;

            pixx_t45 = 4.5 * inv_rho * (1.5 * rho_I * pixx_I  + rho * (ONESIXTH - 0.5 * uxVar)); //A35
            piyy_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * piyy_I - pizz_I); //A36
            pizz_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * pizz_I - piyy_I); //A39
            pixy_t90 = 9.0 * inv_rho * (2.0 * rho_I * pixy_I - ONETHIRD*rho*uyVar); //A37
            pixz_t90 = 9.0 * inv_rho * (2.0 * rho_I * pixz_I - ONETHIRD*rho*uzVar); //A40
            piyz_t90 = 9.0 * inv_rho * rho_I * piyz_I; //A38

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;
            break;
        case WEST:
            //l1 = -1 // l2 = 0 // l3 = 0
            //u1 = ux // u2  = uy // u3 == uz
            uxVar = 0.0;  
            uyVar = 0.0;  
            uzVar = 0.0;  

            //1/7/9/13/15
            rho_I = pop[0] + pop[2] + pop[3] + pop[4] + pop[5] + pop[6] + pop[8] + pop[10] + pop[11] + pop[12]+ pop[14] + pop[16] + pop[17] + pop[18];
            inv_rho_I = 1.0 / rho_I;

            pixx_I = inv_rho_I *  (pop[2] + pop[8] + pop[10] + pop[14] + pop[16] - cs2* rho_I) ;
            pixy_I = inv_rho_I * (( pop[ 8]) - ( pop[14]));
            pixz_I = inv_rho_I * (( pop[10]) - ( pop[16]));
            piyy_I = inv_rho_I *  (pop[3] + pop[4] + pop[8] + pop[11] + pop[12] + pop[14] + pop[17] + pop[18] - cs2* rho_I);
            piyz_I = inv_rho_I * ((pop[11]+pop[12])-(pop[17]+pop[18]));
            pizz_I = inv_rho_I *  (pop[5] + pop[6] + pop[10] + pop[11] + pop[12] + pop[16] + pop[17] + pop[18] - cs2* rho_I);


            rho = rho_I * ( 9.0 * T_OMEGA * (pixx_I) + 12.0) / (OMEGA * (1.0 - 6.0 * uxVar * uxVar) + 3.0 * uxVar * OMEGA_P1 + 9.0); //A34
            inv_rho = 1.0/rho;

            pixx_t45 = 4.5 * inv_rho * (1.5 * rho_I * pixx_I  + rho * (ONESIXTH + 0.5 * uxVar)); //A35
            piyy_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * piyy_I - pizz_I); //A36
            pizz_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * pizz_I - piyy_I); //A39
            pixy_t90 = 9.0 * inv_rho * (2.0 * rho_I * pixy_I + ONETHIRD*rho*uyVar); //A37
            pixz_t90 = 9.0 * inv_rho * (2.0 * rho_I * pixz_I + ONETHIRD*rho*uzVar); //A40
            piyz_t90 = 9.0 * inv_rho * rho_I * piyz_I; //A38

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;
            break;
        //periodic
        case BACK:
            /*
            //l1 = -1 // l2 = 0 // l3 = 0
            //u1 = uz // u2  = ux // u3 == uy
            uxVar = 0.0;  
            uyVar = 0.0;  
            uzVar = 0.0;  

            //5/9/11/16/18
            rho_I = pop[0] + pop[1] + pop[2] + pop[3] + pop[4] + pop[6] + pop[7] + pop[8] + pop[10] + pop[12] + pop[13] + pop[14] + pop[15] + pop[17];
            inv_rho_I = 1.0 / rho_I;

            pixx_I = inv_rho_I *  (pop[1] + pop[2] + pop[7] + pop[8] + pop[10] + pop[13] + pop[14] + pop[15] - cs2* rho_I) ;
            pixy_I = inv_rho_I * ((pop[7] + pop[ 8]) - (pop[13] + pop[14]));
            pixz_I = inv_rho_I * (( pop[10]) - (pop[15] ));
            piyy_I = inv_rho_I *  (pop[3] + pop[4] + pop[7] + pop[8] + pop[12] + pop[13] + pop[14] + pop[17] - cs2* rho_I);
            piyz_I = inv_rho_I * ((pop[12])-(pop[17]));
            pizz_I = inv_rho_I *  ( pop[6] + pop[10] + pop[12] + pop[15]  + pop[17] - cs2* rho_I);


            rho = rho_I * ( 9.0 * T_OMEGA * (pizz_I) + 12.0) / (OMEGA * (1.0 - 6.0 * uzVar * uzVar) + 3.0 * uzVar * OMEGA_P1 + 9.0); //A34
            inv_rho = 1.0/rho;

            pizz_t45 = 4.5 * inv_rho * (1.5 * rho_I * pizz_I  + rho * (ONESIXTH + 0.5 * uzVar)); //A35
            piyy_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * piyy_I - pixx_I); //A36
            pixx_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * pixx_I - piyy_I); //A39
            pixz_t90 = 9.0 * inv_rho * (2.0 * rho_I * pixz_I + ONETHIRD*rho*uxVar); //A37
            piyz_t90 = 9.0 * inv_rho * (2.0 * rho_I * piyz_I + ONETHIRD*rho*uyVar); //A40
            pixy_t90 = 9.0 * inv_rho * rho_I * pixy_I; //A38

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;
            */
            break;
        case FRONT:
            /*
            //l1 = 1 // l2 = 0 // l3 = 0
            //u1 = uz // u2  = ux // u3 == uy
            uxVar = 0.0;  
            uyVar = 0.0;  
            uzVar = 0.0;  

            //6/10/12/15/17
            rho_I = pop[0] + pop[1] + pop[2] + pop[3] + pop[4] + pop[5] + pop[7] + pop[8] + pop[9] + pop[11] + pop[13] + pop[14] + pop[16] + pop[18];
            inv_rho_I = 1.0 / rho_I;

            pixx_I = inv_rho_I *  (pop[1] + pop[2] + pop[7] + pop[8] + pop[9] + pop[13] + pop[14] + pop[16] - cs2* rho_I) ;
            pixy_I = inv_rho_I * ((pop[7] + pop[ 8]) - (pop[13] + pop[14]));
            pixz_I = inv_rho_I * ((pop[9] ) - (+ pop[16]));
            piyy_I = inv_rho_I *  (pop[3] + pop[4] + pop[7] + pop[8] + pop[11] + pop[13] + pop[14] + pop[18] - cs2* rho_I);
            piyz_I = inv_rho_I * ((pop[11] )-(pop[18]));
            pizz_I = inv_rho_I *  (pop[5] + pop[9] + pop[11] + pop[16] + pop[18] - cs2* rho_I);


            rho = rho_I * ( 9.0 * T_OMEGA * (pizz_I) + 12.0)/ (OMEGA * (1.0 - 6.0 * uzVar * uzVar) - 3.0 * uzVar * OMEGA_P1 + 9.0); //A34
            inv_rho = 1.0/rho;

            pizz_t45 = 4.5 * inv_rho * (1.5 * rho_I * pizz_I  + rho * (ONESIXTH - 0.5 * uzVar)); //A35
            piyy_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * piyy_I - pixx_I); //A36
            pixx_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * pixx_I - piyy_I); //A39
            pixz_t90 = 9.0 * inv_rho * (2.0 * rho_I * pixz_I - ONETHIRD*rho*uxVar); //A37
            piyz_t90 = 9.0 * inv_rho * (2.0 * rho_I * piyz_I - ONETHIRD*rho*uyVar); //A40
            pixy_t90 = 9.0 * inv_rho * rho_I * pixy_I; //A38

            ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;
            */
            break;
        default:
            break;

}


/*   

//l1 = 1 // l2 = 0 // l3 = 0
//u1 = uy // u2  = ux // u3 == uz
__device__
void gpuBCMomentN( dfloat* pop, dfloat& rhoVar, char dNodeType,
    &uxVar , &uyVar , dfloat& uzVar , 
    &pixx  , &pixy  , dfloat& pixz  , 
    &piyy  , &piyz  , dfloat& pizz){

    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0;  

    //IO: 3/7/11/14/17
    rho_I = pop[0] + pop[1] + pop[2] + pop[4] + pop[5] + pop[6] + pop[8] + pop[9] + pop[10] + pop[12] + pop[13] + pop[15] + pop[16] + pop[18];
    inv_rho_I = 1.0 / rho_I;

    pixx_I = inv_rho_I *  (pop[1] + pop[2] + pop[8] + pop[9] + pop[10] + pop[13] + pop[15] + pop[16] -  cs2*rho_I);
    pixy_I = inv_rho_I * (( pop[ 8]) - (pop[13] ));
    pixz_I = inv_rho_I * ((pop[9] + pop[10]) - (pop[15] + pop[16]));
    piyy_I = inv_rho_I *  ( pop[4]  + pop[8]+ pop[12] + pop[13] + pop[18] - cs2*rho_I);
    piyz_I = inv_rho_I * ((pop[12])-(pop[18]));
    pizz_I = inv_rho_I *  (pop[5] + pop[6] + pop[9] + pop[10] + pop[12] + pop[15] + pop[16]+ pop[18] - cs2*rho_I);

    rho = rho_I * (9.0 * T_OMEGA * (piyy_I) + 12.0) / (OMEGA * (1.0 - 6.0 * uyVar * uyVar) - 3.0 * uyVar * OMEGA_P1 + 9.0); //A34
    inv_rho = 1.0/rho;

    piyy_t45 = 4.5 * inv_rho * (1.5 * rho_I * piyy_I + rho * (ONESIXTH - 0.5 * uyVar)); //A35
    pixx_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * pixx_I - pizz_I); //A36
    pizz_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * pizz_I - pixx_I); //A39
    pixy_t90 = 9.0 * inv_rho * (2.0 * rho_I * pixy_I - ONETHIRD*rho*uxVar); //A37
    piyz_t90 = 9.0 * inv_rho * (2.0 * rho_I * piyz_I - ONETHIRD*rho*uzVar); //A40       
    pixz_t90 = 9.0 * inv_rho * rho_I * pixz_I; //A38

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;

}


//l1 = -1 // l2 = 0 // l3 = 0
//u1 = uy // u2  = ux // u3 == uz
__device__
void gpuBCMomentS( dfloat* pop, dfloat& rhoVar, char dNodeType,
    &uxVar , &uyVar , dfloat& uzVar , 
    &pixx  , &pixy  , dfloat& pixz  , 
    &piyy  , &piyz  , dfloat& pizz){

    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0;  

    //IO: 4/8/12/13/18
    rho_I = pop[0] + pop[1] + pop[2] + pop[3] + pop[5] + pop[6] + pop[7] + pop[9] + pop[10] + pop[11] + pop[14] + pop[15] + pop[16] + pop[17]; 
    inv_rho_I = 1.0 / rho_I; 

    pixx_I = inv_rho_I *   (pop[1] + pop[2] + pop[7] + pop[9] + pop[10] + pop[14] + pop[15] + pop[16] -  cs2*rho_I);
    pixy_I = inv_rho_I *  ((pop[7]) - (pop[14]));
    pixz_I = inv_rho_I *  ((pop[9] + pop[10]) - (pop[15] + pop[16]));
    piyy_I = inv_rho_I *   (pop[3] +pop[7] + pop[11] + pop[14] + pop[17]  - cs2*rho_I);
    piyz_I = inv_rho_I *  ((pop[11])-(pop[17]));
    pizz_I = inv_rho_I *   (pop[5] + pop[6] + pop[9] + pop[10] + pop[11] + pop[15] + pop[16] + pop[17]  - cs2*rho_I);

    rho = rho_I * (9.0 * T_OMEGA * (piyy_I) + 12.0) / (OMEGA * (1.0 - 6.0 * uyVar * uyVar) + 3.0 * uyVar * OMEGA_P1 + 9.0); //A34
    inv_rho = 1.0/rho;

    piyy_t45 = 4.5 * inv_rho * (1.5 * rho_I * piyy_I + rho * (ONESIXTH + 0.5 * uyVar)); //A35
    pixx_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * pixx_I - pizz_I); //A36
    pizz_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * pizz_I - pixx_I); //A39
    pixy_t90 = 9.0 * inv_rho * (2.0 * rho_I * pixy_I + ONETHIRD*rho*uxVar); //A37
    piyz_t90 = 9.0 * inv_rho * (2.0 * rho_I * piyz_I + ONETHIRD*rho*uzVar); //A40      
    pixz_t90 = 9.0 * inv_rho * rho_I * pixz_I; //A38

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;

}


//l1 = -1 // l2 = 0 // l3 = 0
//u1 = ux // u2  = uy // u3 == uz
__device__
void gpuBCMomentW( dfloat* pop, dfloat& rhoVar, char dNodeType, // x = 0
    &uxVar , &uyVar , dfloat& uzVar , 
    &pixx  , &pixy  , dfloat& pixz  , 
    &piyy  , &piyz  , dfloat& pizz){

    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0;  

    //1/7/9/13/15
    rho_I = pop[0] + pop[2] + pop[3] + pop[4] + pop[5] + pop[6] + pop[8] + pop[10] + pop[11] + pop[12]+ pop[14] + pop[16] + pop[17] + pop[18];
    inv_rho_I = 1.0 / rho_I;

    pixx_I = inv_rho_I *  (pop[2] + pop[8] + pop[10] + pop[14] + pop[16] - cs2* rho_I) ;
    pixy_I = inv_rho_I * (( pop[ 8]) - ( pop[14]));
    pixz_I = inv_rho_I * (( pop[10]) - ( pop[16]));
    piyy_I = inv_rho_I *  (pop[3] + pop[4] + pop[8] + pop[11] + pop[12] + pop[14] + pop[17] + pop[18] - cs2* rho_I);
    piyz_I = inv_rho_I * ((pop[11]+pop[12])-(pop[17]+pop[18]));
    pizz_I = inv_rho_I *  (pop[5] + pop[6] + pop[10] + pop[11] + pop[12] + pop[16] + pop[17] + pop[18] - cs2* rho_I);


    rho = rho_I * ( 9.0 * T_OMEGA * (pixx_I) + 12.0) / (OMEGA * (1.0 - 6.0 * uxVar * uxVar) + 3.0 * uxVar * OMEGA_P1 + 9.0); //A34
    inv_rho = 1.0/rho;

    pixx_t45 = 4.5 * inv_rho * (1.5 * rho_I * pixx_I  + rho * (ONESIXTH + 0.5 * uxVar)); //A35
    piyy_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * piyy_I - pizz_I); //A36
    pizz_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * pizz_I - piyy_I); //A39
    pixy_t90 = 9.0 * inv_rho * (2.0 * rho_I * pixy_I + ONETHIRD*rho*uyVar); //A37
    pixz_t90 = 9.0 * inv_rho * (2.0 * rho_I * pixz_I + ONETHIRD*rho*uzVar); //A40
    piyz_t90 = 9.0 * inv_rho * rho_I * piyz_I; //A38

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;

}


//l1 = 1 // l2 = 0 // l3 = 0
//u1 = ux // u2  = uy // u3 == uz
__device__
void gpuBCMomentE( dfloat* pop, dfloat& rhoVar, char dNodeType, //x = NX
    &uxVar , &uyVar , dfloat& uzVar , 
    &pixx  , &pixy  , dfloat& pixz  , 
    &piyy  , &piyz  , dfloat& pizz){

    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0;  

    //2/8//10/14/16
    rho_I = pop[0] + pop[1] + pop[3] + pop[4] + pop[5] + pop[6] + pop[7] + pop[9] + pop[11] + pop[12] + pop[13] + pop[15] + pop[17] + pop[18];
    inv_rho_I = 1.0 / rho_I;

    pixx_I = inv_rho_I *  (pop[1] + pop[7] + pop[9] + pop[13] + pop[15]  - cs2* rho_I) ;
    pixy_I = inv_rho_I * ((pop[7] ) - (pop[13] ));
    pixz_I = inv_rho_I * ((pop[9] ) - (pop[15] ));
    piyy_I = inv_rho_I *  (pop[3] + pop[4] + pop[7] + pop[11] + pop[12] + pop[13] + pop[17] + pop[18] - cs2* rho_I);
    piyz_I = inv_rho_I * ((pop[11]+pop[12])-(pop[17]+pop[18]));
    pizz_I = inv_rho_I *  (pop[5] + pop[6] + pop[9] + pop[11] + pop[12] + pop[15] + pop[17] + pop[18] - cs2* rho_I);


    rho = rho_I * ( 9.0 * T_OMEGA * (pixx_I) + 12.0) / (OMEGA * (1.0 - 6.0 * uxVar * uxVar) - 3.0 * uyVar * OMEGA_P1 + 9.0); //A34
    inv_rho = 1.0/rho;

    pixx_t45 = 4.5 * inv_rho * (1.5 * rho_I * pixx_I  + rho * (ONESIXTH - 0.5 * uxVar)); //A35
    piyy_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * piyy_I - pizz_I); //A36
    pizz_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * pizz_I - piyy_I); //A39
    pixy_t90 = 9.0 * inv_rho * (2.0 * rho_I * pixy_I - ONETHIRD*rho*uyVar); //A37
    pixz_t90 = 9.0 * inv_rho * (2.0 * rho_I * pixz_I - ONETHIRD*rho*uzVar); //A40
    piyz_t90 = 9.0 * inv_rho * rho_I * piyz_I; //A38

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;

}


//l1 = -1 // l2 = 0 // l3 = 0
//u1 = uz // u2  = ux // u3 == uy
__device__
void gpuBCMomentB( dfloat* pop, dfloat& rhoVar, char dNodeType, // z = 0
    &uxVar , &uyVar , dfloat& uzVar , 
    &pixx  , &pixy  , dfloat& pixz  , 
    &piyy  , &piyz  , dfloat& pizz){

    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0;  

    //5/9/11/16/18
    rho_I = pop[0] + pop[1] + pop[2] + pop[3] + pop[4] + pop[6] + pop[7] + pop[8] + pop[10] + pop[12] + pop[13] + pop[14] + pop[15] + pop[17];
    inv_rho_I = 1.0 / rho_I;

    pixx_I = inv_rho_I *  (pop[1] + pop[2] + pop[7] + pop[8] + pop[10] + pop[13] + pop[14] + pop[15] - cs2* rho_I) ;
    pixy_I = inv_rho_I * ((pop[7] + pop[ 8]) - (pop[13] + pop[14]));
    pixz_I = inv_rho_I * (( pop[10]) - (pop[15] ));
    piyy_I = inv_rho_I *  (pop[3] + pop[4] + pop[7] + pop[8] + pop[12] + pop[13] + pop[14] + pop[17] - cs2* rho_I);
    piyz_I = inv_rho_I * ((pop[12])-(pop[17]));
    pizz_I = inv_rho_I *  ( pop[6] + pop[10] + pop[12] + pop[15]  + pop[17] - cs2* rho_I);


    rho = rho_I * ( 9.0 * T_OMEGA * (pizz_I) + 12.0) / (OMEGA * (1.0 - 6.0 * uzVar * uzVar) + 3.0 * uzVar * OMEGA_P1 + 9.0); //A34
    inv_rho = 1.0/rho;

    pizz_t45 = 4.5 * inv_rho * (1.5 * rho_I * pizz_I  + rho * (ONESIXTH + 0.5 * uzVar)); //A35
    piyy_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * piyy_I - pixx_I); //A36
    pixx_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * pixx_I - piyy_I); //A39
    pixz_t90 = 9.0 * inv_rho * (2.0 * rho_I * pixz_I + ONETHIRD*rho*uxVar); //A37
    piyz_t90 = 9.0 * inv_rho * (2.0 * rho_I * piyz_I + ONETHIRD*rho*uyVar); //A40
    pixy_t90 = 9.0 * inv_rho * rho_I * pixy_I; //A38

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;

}

//l1 = 1 // l2 = 0 // l3 = 0
//u1 = uz // u2  = ux // u3 == uy
__device__
void gpuBCMomentF( dfloat* pop, dfloat& rhoVar, char dNodeType, //z = NZ
    &uxVar , &uyVar , dfloat& uzVar , 
    &pixx  , &pixy  , dfloat& pixz  , 
    &piyy  , &piyz  , dfloat& pizz){

    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0;  

    //6/10/12/15/17
    rho_I = pop[0] + pop[1] + pop[2] + pop[3] + pop[4] + pop[5] + pop[7] + pop[8] + pop[9] + pop[11] + pop[13] + pop[14] + pop[16] + pop[18];
    inv_rho_I = 1.0 / rho_I;

    pixx_I = inv_rho_I *  (pop[1] + pop[2] + pop[7] + pop[8] + pop[9] + pop[13] + pop[14] + pop[16] - cs2* rho_I) ;
    pixy_I = inv_rho_I * ((pop[7] + pop[ 8]) - (pop[13] + pop[14]));
    pixz_I = inv_rho_I * ((pop[9] ) - (+ pop[16]));
    piyy_I = inv_rho_I *  (pop[3] + pop[4] + pop[7] + pop[8] + pop[11] + pop[13] + pop[14] + pop[18] - cs2* rho_I);
    piyz_I = inv_rho_I * ((pop[11] )-(pop[18]));
    pizz_I = inv_rho_I *  (pop[5] + pop[9] + pop[11] + pop[16] + pop[18] - cs2* rho_I);


    rho = rho_I * ( 9.0 * T_OMEGA * (pizz_I) + 12.0)/ (OMEGA * (1.0 - 6.0 * uzVar * uzVar) - 3.0 * uzVar * OMEGA_P1 + 9.0); //A34
    inv_rho = 1.0/rho;

    pizz_t45 = 4.5 * inv_rho * (1.5 * rho_I * pizz_I  + rho * (ONESIXTH - 0.5 * uzVar)); //A35
    piyy_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * piyy_I - pixx_I); //A36
    pixx_t45 = 4.5 * inv_rho * (4.0/33.0) * rho_I * (10.0 * pixx_I - piyy_I); //A39
    pixz_t90 = 9.0 * inv_rho * (2.0 * rho_I * pixz_I - ONETHIRD*rho*uxVar); //A37
    piyz_t90 = 9.0 * inv_rho * (2.0 * rho_I * piyz_I - ONETHIRD*rho*uyVar); //A40
    pixy_t90 = 9.0 * inv_rho * rho_I * pixy_I; //A38

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;

}







//EDGES


//l1 = -1 // l2 = 1 // l3 = 0
//u1 = ux // u2  = uy // u3 == uz
__device__ void 
gpuBCMomentNW(*pop, &rhoVar, char dNodeType,
              &uxVar, &uyVar, &uzVar,
              &pixx, &pixy, &pixz,
              &piyy, &piyz, &pizz){

    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0; 
    
    //IO: 1/4/7/8/9/12/13/15/18 
    rho_I = pop[0] + pop[2] + pop[3] + pop[5] + pop[6] + pop[10] + pop[11] + pop[14] + pop[16] + pop[17];
    inv_rho_I = 1.0 / rho_I;
    pixx_I = inv_rho_I *  (pop[2] + pop[10]  + pop[14]  + pop[16] - cs2*rho_I);
    pixy_I = inv_rho_I * ( - (pop[14]));
    pixz_I = inv_rho_I * ((pop[10]) - (pop[16])) ;
    piyy_I = inv_rho_I *  (pop[3] + pop[11] + pop[14] + pop[17] - cs2*rho_I);
    piyz_I = inv_rho_I * ((pop[11])-(pop[17]));
    pizz_I = inv_rho_I *  (pop[5] + pop[6] + pop[10] + pop[11] + pop[16] + pop[17] - cs2*rho_I); 

    bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * pixx_I + 8.0 * piyy_I 
                - 2.0*pizz_I + 19.0*pixy_I); //A28
    dE = 720.0 - 660.0 * (-uxVar + uyVar) + OMEGA * (430.0 - 30.0 * (-uxVar + uyVar) - 414.0*uxVar*uyVar
                -690.0 * (uxVar*uxVar + uyVar*uyVar) - 69.0 * uzVar*uzVar); //A29

    rho = rho_I * bE / dE; //A27
    inv_rho = 1.0/rho; 

    //                                                                         v this sign may be wrong
    pixx_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pixx_I + piyy_I - 6.0*pizz_I + 34.0*pixy_I) - (2.0/69.0)*(-8.0 - 15.0*uxVar + 8.0*uyVar)); //A30
    piyy_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * piyy_I + pixx_I - 6.0*pizz_I + 34.0*pixy_I) - (2.0/69.0)*(-8.0 + 15.0*uzVar - 8.0*uxVar)); //A30  
    pizz_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 * pixx_I - 9.0*piyy_I + 54.0 * pizz_I - 30.0 * pixy_I) - (4.0/69.0) * (1.0- uxVar + uzVar)); //A31
    pixz_t90 = 9.0 * (inv_rho * 2.0 * pixz_I + ONETHIRD * uzVar); //A33
    piyz_t90 = 9.0 * (inv_rho * 2.0 * piyz_I - ONETHIRD * uzVar); //A33
    pixy_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * (-(-17.0*pixx_I - 17.0*piyy_I + 10.0*pizz_I) + 118.0*pixy_I) - (19.0/69.0)*(-1.0 + uxVar - uzVar)); //A32

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;                  
}

//l1 = 1 // l2 = 1 // l3 = 0
//u1 = ux // u2  = uy // u3 == uz            
__device__ void 
gpuBCMomentNE(*pop, &rhoVar, char dNodeType,
              &uxVar, &uyVar, &uzVar,
              &pixx, &pixy, &pixz,
              &piyy, &piyz, &pizz){

    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0; 
    
    //IO: 2/4/8/10/12/13/14/16/18  
    rho_I = pop[0] + pop[1] + pop[3] + pop[5] + pop[6] + pop[7] + pop[9] + pop[11] + pop[15]  + pop[17];
    inv_rho_I = 1.0 / rho_I;
    pixx_I = inv_rho_I *  (pop[1] + pop[7] + pop[9] + pop[15] - cs2*rho_I);
    pixy_I = inv_rho_I * ((pop[7]));
    pixz_I = inv_rho_I * ((pop[9]) - (pop[15])) ;
    piyy_I = inv_rho_I *  (pop[3] + pop[7] + pop[11] + pop[17] - cs2*rho_I);
    piyz_I = inv_rho_I * ((pop[11])-(pop[17]));
    pizz_I = inv_rho_I *  (pop[5] + pop[6] + pop[9] + pop[11] + pop[15] + pop[17] - cs2*rho_I);

    bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * pixx_I + 8.0 * piyy_I 
                - 2.0*pizz_I - 19.0*pixy_I); //A28
    dE = 720.0 - 660.0 * (uxVar + uyVar) + OMEGA * (430.0 - 30.0 * (uxVar + uyVar) + 414.0*uxVar*uyVar
                -690.0 * (uxVar*uxVar + uyVar*uyVar) - 69.0 * uzVar*uzVar); //A29

    rho = rho_I * bE / dE; //A27
    inv_rho = 1.0/rho; 

    //                                                                         v this sign may be wrong
    pixx_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pixx_I + piyy_I - 6.0*pizz_I - 34.0*pixy_I) - (2.0/69.0)*(-8.0 + 15.0*uxVar + 8.0*uyVar)); //A30
    piyy_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * piyy_I + pixx_I - 6.0*pizz_I - 34.0*pixy_I) - (2.0/69.0)*(-8.0 + 15.0*uzVar + 8.0*uxVar));//A30  
    pizz_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 * pixx_I - 9.0*piyy_I + 54.0 * pizz_I + 30.0 * pixy_I) - (4.0/69.0) * (1.0+ uxVar + uzVar)); //A31
    pixz_t90 = 9.0 * (inv_rho * 2.0 * pixz_I - ONETHIRD * uzVar); //A33
    piyz_t90 = 9.0 * (inv_rho * 2.0 * piyz_I - ONETHIRD * uzVar); //A33
    pixy_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * ((-17.0*pixx_I - 17.0*piyy_I + 10.0*pizz_I) + 118.0*pixy_I) - (19.0/69.0)*(1.0 + uxVar + uzVar)); //A32

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;  
         
}

//l1 = -1 // l2 = -1 // l3 = 0
//u1 = ux // u2  = uy // u3 == uz
__device__ void 
gpuBCMomentSW(*pop, &rhoVar, char dNodeType,
              &uxVar, &uyVar, &uzVar,
              &pixx, &pixy, &pixz,
              &piyy, &piyz, &pizz){

    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0; 
    
    //IO: 1/3/7/9/11/13/14/15/17    
    rho_I = pop[0] + pop[2] + pop[4] + pop[5] + pop[6] + pop[8] + pop[10] + pop[12] + pop[16] + pop[18];
    inv_rho_I = 1.0 / rho_I;
    pixx_I = inv_rho_I *  (pop[2] + pop[8] + pop[10] + pop[16] - cs2*rho_I);
    pixy_I = inv_rho_I * ((pop[ 8]));
    pixz_I = inv_rho_I * ((pop[10]) - (pop[16])) ;
    piyy_I = inv_rho_I *  (pop[4] + pop[8] + pop[12] + pop[18] - cs2*rho_I);
    piyz_I = inv_rho_I * ((pop[12]) - (pop[18]));
    pizz_I = inv_rho_I *  (pop[5] + pop[6] + pop[10] + pop[12] + pop[15] + pop[18] - cs2*rho_I);

    bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * pixx_I + 8.0 * piyy_I 
                - 2.0*pizz_I - 19.0*pixy_I); //A28
    dE = 720.0 - 660.0 * (-uxVar - uyVar) + OMEGA * (430.0 - 30.0 * (-uxVar - uyVar) + 414.0*uxVar*uyVar
                -690.0 * (uxVar*uxVar + uyVar*uyVar) - 69.0 * uzVar*uzVar); //A29

    rho = rho_I * bE / dE; //A27
    inv_rho = 1.0/rho; 

    //                                                                         v this sign may be wrong
    pixx_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pixx_I + piyy_I - 6.0*pizz_I - 34.0*pixy_I) - (2.0/69.0)*(-8.0 - 15.0*uxVar - 8.0*uyVar)); //A30
    piyy_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * piyy_I + pixx_I - 6.0*pizz_I - 34.0*pixy_I) - (2.0/69.0)*(-8.0 - 15.0*uzVar - 8.0*uxVar)); //A30  
    pizz_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 * pixx_I - 9.0*piyy_I + 54.0 * pizz_I + 30.0 * pixy_I) - (4.0/69.0) * (1.0- uxVar - uzVar)); //A31
    pixz_t90 = 9.0 * (inv_rho * 2.0 * pixz_I + ONETHIRD * uzVar); //A33
    piyz_t90 = 9.0 * (inv_rho * 2.0 * piyz_I + ONETHIRD * uzVar); //A33
    pixy_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * ((-17.0*pixx_I - 17.0*piyy_I + 10.0*pizz_I) + 118.0*pixy_I) - (19.0/69.0)*(1.0 - uxVar - uzVar)); //A32

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;   
                
}

//l1 = 1 // l2 = -1 // l3 = 0
//u1 = ux // u2  = uy // u3 == uz
__device__ void 
gpuBCMomentSE(*pop, &rhoVar, char dNodeType,
              &uxVar, &uyVar, &uzVar,
              &pixx, &pixy, &pixz,
              &piyy, &piyz, &pizz){

    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0; 
    
    //IO: 2/3/7/8/10/11/14/16/17 
    rho_I = pop[0] + pop[1] + pop[4] + pop[5] + pop[6] + pop[9] + pop[12] + pop[13] + pop[15] + pop[18];
    inv_rho_I = 1.0 / rho_I;
    pixx_I = inv_rho_I *  (pop[1] + pop[9] + pop[13] + pop[15] - cs2*rho_I);
    pixy_I = inv_rho_I * ( - (pop[13]));
    pixz_I = inv_rho_I * ((pop[9]) - (pop[15])) ;
    piyy_I = inv_rho_I *  ( pop[4] + pop[12] + pop[13] + pop[18] - cs2*rho_I);
    piyz_I = inv_rho_I * ((pop[12]) - (pop[18]));
    pizz_I = inv_rho_I *  (pop[5] + pop[6] + pop[9] + pop[12] + pop[15] + pop[18] - cs2*rho_I);

    bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * pixx_I + 8.0 * piyy_I 
                - 2.0*pizz_I + 19.0*pixy_I); //A28
    dE = 720.0 - 660.0 * (uxVar - uyVar) + OMEGA * (430.0 - 30.0 * (uxVar - uyVar) - 414.0*uxVar*uyVar
                -690.0 * (uxVar*uxVar + uyVar*uyVar) - 69.0 * uzVar*uzVar); //A29

    rho = rho_I * bE / dE; //A27
    inv_rho = 1.0/rho;
    
    //                                                                         v this sign may be wrong
    pixx_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pixx_I + piyy_I - 6.0*pizz_I + 34.0*pixy_I) - (2.0/69.0)*(-8.0 + 15.0*uxVar - 8.0*uyVar)); //A30
    piyy_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * piyy_I + pixx_I - 6.0*pizz_I + 34.0*pixy_I) - (2.0/69.0)*(-8.0 + 15.0*uzVar - 8.0*uxVar));//A30  
    pizz_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 * pixx_I - 9.0*piyy_I + 54.0 * pizz_I + 30.0 * pixy_I) - (4.0/69.0) * (-1.0 + uxVar - uzVar)); //A31
    pixz_t90 = 9.0 * (inv_rho * 2.0 * pixz_I - ONETHIRD * uzVar); //A33
    piyz_t90 = 9.0 * (inv_rho * 2.0 * piyz_I + ONETHIRD * uzVar); //A33
    pixy_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * (-(-17.0*pixx_I - 17.0*piyy_I + 10.0*pizz_I) + 118.0*pixy_I) - (19.0/69.0)*(-1.0 - uxVar + uzVar)); //A32

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;                    
}






//l1 = 1 // l2 = 1 // l3 = 0
//u1 = uy // u2  = uz // u3 == ux
__device__ void 
gpuBCMomentNF(*pop, &rhoVar, char dNodeType,
              &uxVar, &uyVar, &uzVar,
              &pixx, &pixy, &pixz,
              &piyy, &piyz, &pizz){

    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0; 
    
    //IO: 4/6/8/10/12/13/15/17/18 
    rho_I = pop[0] + pop[1] + pop[2] + pop[3] + pop[5] + pop[7] + pop[9] + pop[11] + pop[14] + pop[16];
    inv_rho_I = 1.0 / rho_I;
    pixx_I = inv_rho_I *  (pop[1] + pop[2] + pop[7] + pop[9] + pop[14] + pop[16] - cs2*rho_I);
    pixy_I = inv_rho_I * ((pop[7]) - ( pop[14]));
    pixz_I = inv_rho_I * ((pop[9] ) - ( pop[16])) ;
    piyy_I = inv_rho_I *  (pop[3] + pop[7] + pop[11] + pop[14] - cs2*rho_I);
    piyz_I = inv_rho_I * ((pop[11]));
    pizz_I = inv_rho_I *  (pop[5] + pop[9] + pop[11] + pop[16] - cs2*rho_I);

    bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * piyy_I + 8.0 * pizz_I 
                - 2.0*pixx_I - 19.0*piyz_I); //A28
    dE = 720.0 - 660.0 * (uyVar + uzVar) + OMEGA * (430.0 - 30.0 * (uyVar + uzVar) + 414.0*uxVar*uzVar
                -690.0 * (uyVar*uyVar + uzVar*uzVar) - 69.0 * uxVar*uxVar); //A29

    rho = rho_I * bE / dE; //A27
    inv_rho = 1.0/rho;


    piyy_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * piyy_I + pizz_I - 6.0*pixx_I - 34.0*piyz_I) - (2.0/69.0)*(-8.0 + 15.0*uyVar + 8.0*uzVar)); //A30  
    pizz_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pizz_I + piyy_I - 6.0*pixx_I - 34.0*piyz_I) - (2.0/69.0)*(-8.0 + 15.0*uzVar + 8.0*uyVar)); //A30
    pixx_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 * piyy_I - 9.0*pizz_I + 54.0 * pixx_I + 30.0 * piyz_I) - (4.0/69.0) * (1.0 + uyVar + uzVar)); //A31
    pixy_t90 = 9.0 * (inv_rho * 2.0 * pixz_I - ONETHIRD * uxVar); //A33
    pixz_t90 = 9.0 * (inv_rho * 2.0 * pixz_I - ONETHIRD * uxVar); //A33
    piyz_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * ((-17.0*piyy_I - 17.0*pizz_I + 10.0*pixx_I) + 118.0*pixy_I) - (19.0/69.0)*(1.0 + uyVar + uzVar)); //A32

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;                
}

//l1 = 1 // l2 = -1 // l3 = 0
//u1 = uy // u2  = uz // u3 == ux
__device__ void 
gpuBCMomentNB(*pop, &rhoVar, char dNodeType,
              &uxVar, &uyVar, &uzVar,
              &pixx, &pixy, &pixz,
              &piyy, &piyz, &pizz){

    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0; 
    
    //IO:  4/5/8/9/11/12/13/16/18
    rho_I = pop[0] + pop[1] + pop[2] + pop[3] + pop[6] + pop[7] + pop[10] + pop[14] + pop[15] + pop[17];
    inv_rho_I = 1.0 / rho_I;
    pixx_I = inv_rho_I *  (pop[1] + pop[2] + pop[7] + pop[10] + pop[14] + pop[15] - cs2*rho_I);
    pixy_I = inv_rho_I * ((pop[7]) - (pop[14]));
    pixz_I = inv_rho_I * ((pop[10]) - (pop[15])) ;
    piyy_I = inv_rho_I *  (pop[3] + pop[7] + pop[14] + pop[17] - cs2*rho_I);
    piyz_I = inv_rho_I * (- (pop[17]));
    pizz_I = inv_rho_I *  (pop[6] + pop[10] + pop[15] + pop[17] - cs2*rho_I); 

    bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * piyy_I + 8.0 * pizz_I 
                - 2.0*pixx_I + 19.0*piyz_I); //A28
    dE = 720.0 - 660.0 * (uyVar - uzVar) + OMEGA * (430.0 - 30.0 * (uyVar - uzVar) - 414.0*uxVar*uzVar
                -690.0 * (uyVar*uyVar + uzVar*uzVar) - 69.0 * uxVar*uxVar); //A29

    rho = rho_I * bE / dE; //A27
    inv_rho = 1.0/rho;

    piyy_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * piyy_I + pizz_I - 6.0*pixx_I + 34.0*piyz_I) - (2.0/69.0)*(-8.0 + 15.0*uyVar - 8.0*uzVar)); //A30  
    pizz_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pizz_I + piyy_I - 6.0*pixx_I + 34.0*piyz_I) - (2.0/69.0)*(-8.0 - 15.0*uzVar + 8.0*uyVar)); //A30
    pixx_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 * piyy_I - 9.0*pizz_I + 54.0 * pixx_I - 30.0 * piyz_I) - (4.0/69.0) * (1.0 + uyVar - uzVar)); //A31
    pixy_t90 = 9.0 * (inv_rho * 2.0 * pixz_I - ONETHIRD * uxVar); //A33
    pixz_t90 = 9.0 * (inv_rho * 2.0 * pixz_I + ONETHIRD * uxVar); //A33
    piyz_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * (-(-17.0*piyy_I - 17.0*pizz_I + 10.0*pixx_I) + 118.0*pixy_I) - (19.0/69.0)*(-1.0 - uyVar + uzVar)); //A32

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;  

    
                
}

//l1 = -1 // l2 = 1 // l3 = 0
//u1 = uy // u2  = uz // u3 == ux
__device__ void 
gpuBCMomentSF(*pop, &rhoVar, char dNodeType,
              &uxVar, &uyVar, &uzVar,
              &pixx, &pixy, &pixz,
              &piyy, &piyz, &pizz){

    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0; 
    
    //IO: 3/6/7/10/11/12/14/15/17
    rho_I = pop[0] + pop[1] + pop[2] + pop[4] + pop[5] + pop[8] + pop[9] + pop[13] + pop[16] + pop[18];
    inv_rho_I = 1.0 / rho_I;
    pixx_I = inv_rho_I *  (pop[1] + pop[2] + pop[8] + pop[9] + pop[13] + pop[16] - cs2*rho_I);
    pixy_I = inv_rho_I * ((pop[8]) - (pop[13]));
    pixz_I = inv_rho_I * ((pop[9]) - (pop[16])) ;
    piyy_I = inv_rho_I *  (pop[4] + pop[8] + pop[13] + pop[18] - cs2*rho_I);
    piyz_I = inv_rho_I * ( - ( pop[18]));
    pizz_I = inv_rho_I *  (pop[5]  + pop[9] + pop[16] + pop[18] - cs2*rho_I);

    bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * piyy_I + 8.0 * pizz_I 
                - 2.0*pixx_I + 19.0*piyz_I); //A28
    dE = 720.0 - 660.0 * (-uyVar + uzVar) + OMEGA * (430.0 - 30.0 * (-uyVar + uzVar) - 414.0*uxVar*uzVar
                -690.0 * (uyVar*uyVar + uzVar*uzVar) - 69.0 * uxVar*uxVar); //A29

    rho = rho_I * bE / dE; //A27
    inv_rho = 1.0/rho;

    piyy_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * piyy_I + pizz_I - 6.0*pixx_I + 34.0*piyz_I) - (2.0/69.0)*(-8.0 - 15.0*uyVar + 8.0*uzVar));//A30  
    pizz_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pizz_I + piyy_I - 6.0*pixx_I + 34.0*piyz_I) - (2.0/69.0)*(-8.0 + 15.0*uzVar - 8.0*uyVar)); //A30
    pixx_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 * piyy_I - 9.0*pizz_I + 54.0 * pixx_I - 30.0 * piyz_I) - (4.0/69.0) * (1.0 - uyVar + uzVar)); //A31
    pixy_t90 = 9.0 * (inv_rho * 2.0 * pixz_I + ONETHIRD * uxVar); //A33
    pixz_t90 = 9.0 * (inv_rho * 2.0 * pixz_I - ONETHIRD * uxVar); //A33
    piyz_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * (-(-17.0*piyy_I - 17.0*pizz_I + 10.0*pixx_I) + 118.0*pixy_I) - (19.0/69.0)*(-1.0 + uyVar - uzVar)); //A32

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;  
}

//l1 = -1 // l2 = -1 // l3 = 0
//u1 = uy // u2  = uz // u3 == ux
__device__ void 
gpuBCMomentSB(*pop, &rhoVar, char dNodeType,
              &uxVar, &uyVar, &uzVar,
              &pixx, &pixy, &pixz,
              &piyy, &piyz, &pizz){

    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0; 
    
    //IO: 3/5/7/9/11/14/16/17/18
    rho_I = pop[0] + pop[1] + pop[2] + pop[4] + pop[6] + pop[8] + pop[10] + pop[12] + pop[13] + pop[15];
    inv_rho_I = 1.0 / rho_I;
    pixx_I = inv_rho_I *  (pop[1] + pop[2] + pop[8] + pop[10] + pop[13] + pop[15] - cs2*rho_I);
    pixy_I = inv_rho_I * ((pop[8]) - (pop[13]));
    pixz_I = inv_rho_I * ((pop[10]) - (pop[15])) ;
    piyy_I = inv_rho_I *  (pop[4] + pop[8] + pop[12] + pop[13] - cs2*rho_I);
    piyz_I = inv_rho_I * ((pop[12]));
    pizz_I = inv_rho_I *  (pop[6] + pop[10] + pop[12] + pop[15] - cs2*rho_I); 

    bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * piyy_I + 8.0 * pizz_I 
                - 2.0*pixx_I - 19.0*piyz_I); //A28
    dE = 720.0 - 660.0 * (-uyVar - uzVar) + OMEGA * (430.0 - 30.0 * (-uyVar - uzVar) + 414.0*uxVar*uzVar
                -690.0 * (uyVar*uyVar + uzVar*uzVar) - 69.0 * uxVar*uxVar); //A29

    rho = rho_I * bE / dE; //A27
    inv_rho = 1.0/rho;


    piyy_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * piyy_I + pizz_I - 6.0*pixx_I - 34.0*piyz_I) - (2.0/69.0)*(-8.0 - 15.0*uyVar - 8.0*uzVar));//A30  
    pizz_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pizz_I + piyy_I - 6.0*pixx_I - 34.0*piyz_I) - (2.0/69.0)*(-8.0 - 15.0*uzVar - 8.0*uyVar)); //A30
    pixx_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 * piyy_I - 9.0*pizz_I + 54.0 * pixx_I + 30.0 * piyz_I) - (4.0/69.0) * (1.0 - uyVar - uzVar)); //A31
    pixy_t90 = 9.0 * (inv_rho * 2.0 * pixz_I + ONETHIRD * uxVar); //A33
    pixz_t90 = 9.0 * (inv_rho * 2.0 * pixz_I + ONETHIRD * uxVar); //A33
    piyz_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * ((-17.0*piyy_I - 17.0*pizz_I + 10.0*pixx_I) + 118.0*pixy_I) - (19.0/69.0)*(1.0 - uyVar - uzVar)); //A32

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;  
                   
}



//l1 = -1 // l2 = 1 // l3 = 0
//u1 = ux // u2  = uz // u3 == uy
__device__ void 
gpuBCMomentWF(*pop, &rhoVar, char dNodeType,
              &uxVar, &uyVar, &uzVar,
              &pixx, &pixy, &pixz,
              &piyy, &piyz, &pizz){

    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0; 
    
    //IO: 1/6/7/9/10/12/13/15/17
    rho_I = pop[0] + pop[2] + pop[3] + pop[4] + pop[5] + pop[8] + pop[11] + pop[14] + pop[16] + pop[18];
    inv_rho_I = 1.0 / rho_I;
    pixx_I = inv_rho_I *  (pop[2] + pop[8] + pop[14] + pop[16] - cs2*rho_I);
    pixy_I = inv_rho_I * ((pop[ 8]) - (pop[14]));
    pixz_I = inv_rho_I * (- (pop[16])) ;
    piyy_I = inv_rho_I *  (pop[3] + pop[4] + pop[8] + pop[11] + pop[14] + pop[18] - cs2*rho_I);
    piyz_I = inv_rho_I * ((pop[11])-(pop[18]));
    pizz_I = inv_rho_I *  (pop[5] + pop[11]+ pop[16] + pop[18] - cs2*rho_I);

    bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * pixx_I + 8.0 * pizz_I 
                - 2.0*piyy_I + 19.0*pixz_I); //A28
    dE = 720.0 - 660.0 * (uxVar - uzVar) + OMEGA * (430.0 + 30.0 * (uxVar + uzVar) - 414.0*uxVar*uzVar
                -690.0 * (uxVar*uxVar + uzVar*uzVar) - 69.0 * uyVar*uyVar); //A29

    rho = rho_I * bE / dE; //A27
    inv_rho = 1.0/rho; 

    //                                                                         v this sign may be wrong
    pixx_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pixx_I + pizz_I - 6.0*piyy_I + 34.0*pixz_I) - (2.0/69.0)*(-8.0-15.0*uxVar+8.0*uzVar)); //A30
    pizz_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pizz_I + pixx_I - 6.0*piyy_I + 34.0*pixz_I) - (2.0/69.0)*(-8.0+15.0*uzVar-8.0*uxVar));//A30  
    piyy_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 *pixx_I - 9.0*pizz_I + 54.0 * piyy_I - 30.0 * pixz_I) - (4.0/69.0) * (1.0- uxVar + uzVar)); //A31
    pixy_t90 = 9.0 * (inv_rho * 2.0 * pixy_I + ONETHIRD * uyVar); //A33
    piyz_t90 = 9.0 * (inv_rho * 2.0 * piyz_I - ONETHIRD * uyVar); //A33
    pixz_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * (-(-17.0*pixx_I - 17.0*pizz_I + 10.0*piyy_I) + 118.0*pixz_I) - (19.0/69.0)*(-1.0 - uxVar + uzVar)); //A32

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;             
                

}

//l1 = -1 // l2 = -1 // l3 = 0
//u1 = ux // u2  = uz // u3 == uywwd
__device__ void 
gpuBCMomentWB(*pop, &rhoVar, char dNodeType,
              &uxVar, &uyVar, &uzVar,
              &pixx, &pixy, &pixz,
              &piyy, &piyz, &pizz){

    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0;  

    //IO: 1/5/7/9/11/13/15/16/18
    rho_I = pop[0] + pop[2] + pop[3] + pop[4] + pop[6] + pop[8] + pop[10] + pop[12] + pop[14] + pop[17];
    inv_rho_I = 1.0 / rho_I;
    pixx_I = inv_rho_I *  (pop[2] + pop[8] + pop[10] + pop[14] - cs2*rho_I);
    pixy_I = inv_rho_I * ((pop[ 8]) - (pop[14]));
    pixz_I = inv_rho_I * ((pop[10]));
    piyy_I = inv_rho_I *  (pop[3] + pop[4] + pop[8] + pop[12] + pop[14] + pop[17] - cs2*rho_I);
    piyz_I = inv_rho_I * ((pop[12])-(pop[17]));
    pizz_I = inv_rho_I *  (pop[6] + pop[10] + pop[12] + pop[17] - cs2*rho_I);

    bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * pixx_I + 8.0 * pizz_I 
                - 2.0*piyy_I - 19.0*pixz_I); //A28
    dE = 720.0 - 660.0 * (-uxVar - uzVar) + OMEGA * (430.0 + 30.0 * (uxVar + uzVar) + 414.0*uxVar*uzVar
                -690.0 * (uxVar*uxVar + uzVar*uzVar) - 69.0 * uyVar*uyVar); //A29

    rho = rho_I * bE / dE; //A27
    inv_rho = 1.0/rho;

    //                                                                         v this sign may be wrong
    pixx_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pixx_I + pizz_I - 6.0*piyy_I - 34.0*pixz_I) - (2.0/69.0)*(-8.0-15.0*uxVar-8.0*uzVar)); //A30
    pizz_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pizz_I + pixx_I - 6.0*piyy_I - 34.0*pixz_I) - (2.0/69.0)*(-8.0-15.0*uzVar-8.0*uxVar)); //A30
    piyy_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 *pixx_I - 9.0*pizz_I + 54.0 * piyy_I + 30.0 * pixz_I) - (4.0/69.0) * (1.0- uxVar - uzVar)); //A31
    pixy_t90 = 9.0 * (inv_rho * 2.0 * pixy_I + ONETHIRD * uyVar); //A33
    piyz_t90 = 9.0 * (inv_rho * 2.0 * piyz_I + ONETHIRD * uyVar); //A33
    pixz_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * ((-17.0*pixx_I - 17.0*pizz_I + 10.0*piyy_I) + 118.0*pixz_I) - (19.0/69.0)*(1.0 - uxVar - uzVar)); //A32

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;
}

//l1 = 1 // l2 = 1 // l3 = 0
//u1 = ux // u2  = uz // u3 == uy
__device__ void 
gpuBCMomentEF(*pop, &rhoVar, char dNodeType,
              &uxVar, &uyVar, &uzVar,
              &pixx, &pixy, &pixz,
              &piyy, &piyz, &pizz){
    
    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0; 
    
    //IO:2/6/8/10/12/14/15/16/17
    rho_I = pop[0] + pop[1] + pop[3] + pop[4] + pop[5] + pop[7] + pop[9] + pop[11]  + pop[13] + pop[18];
    inv_rho_I = 1.0 / rho_I;
    pixx_I = inv_rho_I *  (pop[1] + pop[7] + pop[9] + pop[13] - cs2*rho_I);
    pixy_I = inv_rho_I * ((pop[7]) - (pop[13]));
    pixz_I = inv_rho_I * ((pop[9])) ;
    piyy_I = inv_rho_I *  (pop[3] + pop[4] + pop[7] + pop[11] + pop[13] + pop[18] - cs2*rho_I);
    piyz_I = inv_rho_I * ((pop[11])-(pop[18]));
    pizz_I = inv_rho_I *  (pop[5] + pop[9] + pop[11] + pop[18] - cs2*rho_I);  
        
    bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * pixx_I + 8.0 * pizz_I 
                - 2.0*piyy_I - 19.0*pixz_I); //A28  
    dE = 720.0 - 660.0 * (uxVar + uzVar) + OMEGA * (430.0 + 30.0 * (uxVar + uzVar) + 414.0*uxVar*uzVar
                -690.0 * (uxVar*uxVar + uzVar*uzVar) - 69.0 * uyVar*uyVar); //A29

    rho = rho_I * bE / dE; //A27
    inv_rho = 1.0/rho; 
    //                                                                         v this sign may be wrong
    pixx_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pixx_I + pizz_I - 6.0*piyy_I - 34.0*pixz_I) - (2.0/69.0)*(-8.0+15.0*uxVar+8.0*uzVar)); //A30
    pizz_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pizz_I + pixx_I - 6.0*piyy_I - 34.0*pixz_I) - (2.0/69.0)*(-8.0+15.0*uzVar+8.0*uxVar)); //)A30    
    piyy_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 *pixx_I - 9.0*pizz_I + 54.0 * piyy_I + 30.0 * pixz_I) - (4.0/69.0) * (1.0+ uxVar + uzVar)); //A31 
    pixy_t90 = 9.0 * (inv_rho * 2.0 * pixy_I - ONETHIRD * uyVar); //A33
    piyz_t90 = 9.0 * (inv_rho * 2.0 * piyz_I - ONETHIRD * uyVar); //A33 
    pixz_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * ((-17.0*pixx_I - 17.0*pizz_I + 10.0*piyy_I) + 118.0*pixz_I) - (19.0/69.0)*(1.0 + uxVar + uzVar)); //A32

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;                            

                  
}

//l1 = 1 // l2 = -1 // l3 = 0
//u1 = ux // u2  = uz // u3 == uy
__device__ void 
gpuBCMomentEB(*pop, &rhoVar, char dNodeType,
              &uxVar, &uyVar, &uzVar,
              &pixx, &pixy, &pixz,
              &piyy, &piyz, &pizz){

    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0; 
    
    //IO:2/5/8/9/10/11/14/16/18
    rho_I = pop[0] + pop[1] + pop[3] + pop[4] + pop[6] + pop[7] + pop[12] + pop[13]  + pop[15]  + pop[17];
    inv_rho_I = 1.0 / rho_I;
    pixx_I = inv_rho_I *  (pop[1] + pop[7] + pop[13] + pop[15] - cs2*rho_I);
    pixy_I = inv_rho_I * ((pop[7]) - (pop[13]));
    pixz_I = inv_rho_I * (- (pop[15])) ;
    piyy_I = inv_rho_I * (pop[3] + pop[4] + pop[7] + pop[12] + pop[13] + pop[17] - cs2*rho_I);
    piyz_I = inv_rho_I * ((pop[12])-(pop[17]));
    pizz_I = inv_rho_I * (pop[6] + pop[12] + pop[15] + pop[17] - cs2*rho_I);

    bE = 1656.0 + 216.0 * T_OMEGA * (8.0 * pixx_I + 8.0 * pizz_I 
                - 2.0*piyy_I + 19.0*pixz_I); //A28
    dE = 720.0 - 660.0 * (uxVar - uzVar) + OMEGA * (430.0 + 30.0 * (uxVar + uzVar) - 414.0*uxVar*uzVar
                -690.0 * (uxVar*uxVar + uzVar*uzVar) - 69.0 * uyVar*uyVar); //A29

    rho = rho_I * bE / dE; //A27
    inv_rho = 1.0/rho;            

    //                                                                         v this sign may be wrong
    pixx_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pixx_I + pizz_I - 6.0*piyy_I + 34.0*pixz_I) - (2.0/69.0)*(-8.0+15.0*uxVar-8.0*uzVar)); //A30
    pizz_t45 = 4.5 * (inv_rho * (1.0/23.0) * rho_I * (47.0 * pizz_I + pixx_I - 6.0*piyy_I + 34.0*pixz_I) - (2.0/69.0)*(-8.0-15.0*uzVar+8.0*uxVar)); //A30
    piyy_t45 = 4.5 * (inv_rho * (2.0/69.0) * rho_I * (-9.0 *pixx_I - 9.0*pizz_I + 54.0 * piyy_I - 30.0 * pixz_I) - (4.0/69.0) * (1.0+ uxVar - uzVar)); //A31 
    pixy_t90 = 9.0 * (inv_rho * 2.0 * pixy_I - ONETHIRD * uyVar); //A33
    piyz_t90 = 9.0 * (inv_rho * 2.0 * piyz_I + ONETHIRD * uyVar); //A33   
    pixz_t90 = 9.0 * (inv_rho * (1.0/23.0) * rho_I * ((-17.0*pixx_I - 17.0*pizz_I + 10.0*piyy_I) + 118.0*pixz_I) - (19.0/69.0)*(1.0 + uxVar - uzVar)); //A32

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;     
}






//CORNERS

// l1 = -1
// l2 = +1
// l3 = +1
__device__ void 
gpuBCMomentNWF(*pop, &rhoVar, char dNodeType,
               &uxVar, &uyVar, &uzVar,
               &pixx, &pixy, &pixz,
               &piyy, &piyz, &pizz){

    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0; 

    //IO: 0/2/3/5/11/14/16
    rho_I = pop[0] + pop[2] + pop[3]  + pop[5] + pop[11] + pop[14] + pop[16];
    inv_rho_I = 1.0 / rho_I;
    pixx_I = inv_rho_I *  (pop[2] + pop[14] + pop[16] - cs2*rho_I);
    pixy_I = inv_rho_I * (- (pop[14]));
    pixz_I = inv_rho_I * (- (pop[16])) ;
    piyy_I = inv_rho_I *  (pop[3] + pop[11] + pop[14] - cs2*rho_I);
    piyz_I = inv_rho_I * ((pop[11]));
    pizz_I = inv_rho_I *  (pop[5] + pop[11] + pop[16] - cs2*rho_I);


    bE = (1.0/24.0)*(T_OMEGA)*(pixx_I + piyy_I + pizz_I 
              +2.0 * pixy_I + 2.0 * pixz_I - 2.0 * piyz_I);
    dE = 4.0 + 10.0*OMEGA + 4*(OMEGA-3.0)*(-uxVar + uyVar + uzVar) 
              - 9.0*OMEGA*(uxVar*uxVar + uyVar*uyVar + uzVar*uzVar) + 6.0* OMEGA *
              ( -uxVar * uyVar + -uxVar * uzVar + uyVar*uzVar);

    rho = rho_I * bE / dE; //A27
    inv_rho = 1.0/rho;        

    pixx_t45 = 4.5 *( inv_rho * ONETHIRD * rho_I * (10.0 * pixx_I - 2.0*piyy_I - 2.0 * pizz_I + 6.0*(pixy_I + pixz_I + piyz_I)) + (2.0/9.0) * (1.0 + 2.0*uxVar + uyVar + uzVar));
    piyy_t45 = 4.5 *( inv_rho * ONETHIRD * rho_I * (10.0 * piyy_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(pixy_I - piyz_I - pixz_I)) + (2.0/9.0) * (1.0 - 2.0*uyVar - uxVar + uzVar));
    pizz_t45 = 4.5 *( inv_rho * ONETHIRD * rho_I * (10.0 * pizz_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(pixz_I - piyz_I - pixy_I)) + (2.0/9.0) * (1.0 - 2.0*uzVar - uxVar + uyVar));
    pixy_t90 = 9.0 *( inv_rho * ONETHIRD * (+3.0 * pixx_I +3.0 * piyy_I - 3.0* pizz_I + 17.0*pixy_I - pixz_I + piyz_I) - (2.0/9.0) * (-1.0 - uyVar + uxVar - uzVar));
    pixz_t90 = 9.0 *( inv_rho * ONETHIRD * (+3.0 * pixx_I +3.0 * pizz_I - 3.0* piyy_I + 17.0*pixz_I - pixy_I + piyz_I) - (2.0/9.0) * (-1.0 - uzVar + uxVar - uyVar));
    piyz_t90 = 9.0 *( inv_rho * ONETHIRD * (-3.0 * piyy_I -3.0 * pizz_I + 3.0* pixx_I + 17.0*piyz_I + pixy_I + pixz_I) - (2.0/9.0) * (1.0 + uzVar + uyVar - uxVar));

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;             
     
}

// l1 = -1
// l2 = +1
// l3 = -1
__device__ void 
gpuBCMomentNWB(*pop, &rhoVar, char dNodeType,
               &uxVar, &uyVar, &uzVar,
               &pixx, &pixy, &pixz,
               &piyy, &piyz, &pizz){
                       
    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0; 

    //IO: 0/2/3/6/10/14/17
    rho_I = pop[0]  + pop[2] + pop[3] + pop[6] + pop[10] + pop[14] + pop[17];
    inv_rho_I = 1.0 / rho_I;
    pixx_I = inv_rho_I *  (pop[2] + pop[10] + pop[14] - cs2*rho_I);
    pixy_I = inv_rho_I * ( - (pop[14]));
    pixz_I = inv_rho_I * ((pop[9])) ;
    piyy_I = inv_rho_I *  (pop[3] + pop[14] + pop[17] - cs2*rho_I);
    piyz_I = inv_rho_I * ( - (pop[17]));
    pizz_I = inv_rho_I *  (pop[6] + pop[10] + pop[17] - cs2*rho_I);


    bE = (1.0/24.0)*(T_OMEGA)*(pixx_I + piyy_I + pizz_I 
              +2.0 * pixy_I - 2.0 * pixz_I + 2.0 * piyz_I);
    dE = 4.0 + 10.0*OMEGA + 4*(OMEGA-3.0)*(-uxVar + uyVar + -uzVar) 
              - 9.0*OMEGA*(uxVar*uxVar + uyVar*uyVar + uzVar*uzVar) + 6.0* OMEGA *
              ( -uxVar * uyVar + uxVar * uzVar - uyVar*uzVar);

    rho = rho_I * bE / dE; //A27
    inv_rho = 1.0/rho;         
       
    pixx_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pixx_I - 2.0*piyy_I - 2.0 * pizz_I + 6.0*(pixy_I - pixz_I - piyz_I)) + (2.0/9.0) * (1.0 + 2.0*uxVar + uyVar - uzVar));
    piyy_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * piyy_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(pixy_I + piyz_I + pixz_I)) + (2.0/9.0) * (1.0 - 2.0*uyVar - uxVar - uzVar));
    pizz_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pizz_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(-pixz_I + piyz_I - pixy_I)) + (2.0/9.0) * (1.0 + 2.0*uzVar - uxVar + uyVar));
    pixy_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * pixx_I +3.0 * piyy_I - 3.0* pizz_I + 17.0*pixy_I + pixz_I - piyz_I) - (2.0/9.0) * (-1.0 - uyVar + uxVar + uzVar));
    pixz_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * pixx_I -3.0 * pizz_I - 3.0* piyy_I + 17.0*pixz_I + pixy_I + piyz_I) - (2.0/9.0) * (1.0 - uzVar - uxVar + uyVar));
    piyz_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * piyy_I +3.0 * pizz_I - 3.0* pixx_I + 17.0*piyz_I - pixy_I + pixz_I) - (2.0/9.0) * (-1.0 + uzVar - uyVar + uxVar));

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;    
}

// l1 = +1
// l2 = +1
// l3 = +1
__device__ void 
gpuBCMomentNEF(*pop, &rhoVar, char dNodeType,
               &uxVar, &uyVar, &uzVar,
               &pixx, &pixy, &pixz,
               &piyy, &piyz, &pizz){

    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0; 

    //IO: 0/1/3/5/7/9/11
    rho_I = pop[0] + pop[1]  + pop[3]  + pop[5]  + pop[7]  + pop[9]  + pop[11];
    inv_rho_I = 1.0 / rho_I;
    pixx_I = inv_rho_I *  (pop[1] + pop[7] + pop[9] - cs2*rho_I);
    pixy_I = inv_rho_I * ((pop[7]));
    pixz_I = inv_rho_I * ((pop[9])) ;
    piyy_I = inv_rho_I *  (pop[3]  + pop[7]  + pop[11]  - cs2*rho_I);
    piyz_I = inv_rho_I * ((pop[11] ) );
    pizz_I = inv_rho_I *  (pop[5]  + pop[9]  + pop[11] - cs2*rho_I);


    bE = (1.0/24.0)*(T_OMEGA)*(pixx_I + piyy_I + pizz_I 
              -2.0 * pixy_I - 2.0 * pixz_I - 2.0 * piyz_I);
    dE = 4.0 + 10.0*OMEGA + 4*(OMEGA-3.0)*(uxVar + uyVar + uzVar) 
              - 9.0*OMEGA*(uxVar*uxVar + uyVar*uyVar + uzVar*uzVar) + 6.0* OMEGA *
              ( uxVar * uyVar + uxVar * uzVar + uyVar*uzVar);

    rho = rho_I * bE / dE; //A27
    inv_rho = 1.0/rho;            

    pixx_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pixx_I - 2.0*piyy_I - 2.0 * pizz_I + 6.0*(-pixy_I - pixz_I + piyz_I)) + (2.0/9.0) * (1.0 - 2.0*uxVar + uyVar + uzVar));
    piyy_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * piyy_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(-pixy_I - piyz_I + pixz_I)) + (2.0/9.0) * (1.0 - 2.0*uyVar + uxVar + uzVar));
    pizz_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pizz_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(-pixz_I - piyz_I + pixy_I)) + (2.0/9.0) * (1.0 - 2.0*uzVar + uxVar + uyVar));
    pixy_t90 = 9.0 * (inv_rho * ONETHIRD * (-3.0 * pixx_I -3.0 * piyy_I + 3.0* pizz_I + 17.0*pixy_I - pixz_I - piyz_I) - (2.0/9.0) * (1.0 + uyVar + uxVar + uzVar));
    pixz_t90 = 9.0 * (inv_rho * ONETHIRD * (-3.0 * pixx_I -3.0 * pizz_I + 3.0* piyy_I + 17.0*pixz_I - pixy_I - piyz_I) - (2.0/9.0) * (1.0 + uzVar + uxVar + uyVar));
    piyz_t90 = 9.0 * (inv_rho * ONETHIRD * (-3.0 * piyy_I -3.0 * pizz_I + 3.0* pixx_I + 17.0*piyz_I - pixy_I - pixz_I) - (2.0/9.0) * (1.0 + uzVar + uyVar + uxVar));

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;     
}


// l1 = +1
// l2 = +1
// l3 = -1
__device__ void 
gpuBCMomentNEB(*pop, &rhoVar, char dNodeType,
               &uxVar, &uyVar, &uzVar,
               &pixx, &pixy, &pixz,
               &piyy, &piyz, &pizz){
    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0; 

    //IO: 0/1/3/6/7/15/17
    rho_I = pop[0] + pop[1] + pop[3]  + pop[6] + pop[7] + pop[15]  + pop[17];
    inv_rho_I = 1.0 / rho_I;
    pixx_I = inv_rho_I *  (pop[1] + pop[7] + pop[15]  - cs2*rho_I);
    pixy_I = inv_rho_I * ((pop[7] ) );
    pixz_I = inv_rho_I * ( - (pop[15] )) ;
    piyy_I = inv_rho_I *  (pop[3] + pop[7] + pop[17]  - cs2*rho_I);
    piyz_I = inv_rho_I * ( - (pop[17] ));
    pizz_I = inv_rho_I *  (pop[6] + pop[15] + pop[17] - cs2*rho_I);                   


    bE = (1.0/24.0)*(T_OMEGA)*(pixx_I + piyy_I + pizz_I 
              -2.0 * pixy_I - 2.0 * pixz_I + 2.0 * piyz_I);
    dE = 4.0 + 10.0*OMEGA + 4*(OMEGA-3.0)*(uxVar + uyVar -uzVar) 
              - 9.0*OMEGA*(uxVar*uxVar + uyVar*uyVar + uzVar*uzVar) + 6.0* OMEGA *
              ( uxVar * uyVar - uxVar * uzVar - uyVar*uzVar);

    rho = rho_I * bE / dE; //A27
    inv_rho = 1.0/rho;    

    pixx_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pixx_I - 2.0*piyy_I - 2.0 * pizz_I + 6.0*(-pixy_I + pixz_I - piyz_I)) + (2.0/9.0) * (1.0 - 2.0*uxVar + uyVar - uzVar));
    piyy_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * piyy_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(-pixy_I + piyz_I - pixz_I)) + (2.0/9.0) * (1.0 - 2.0*uyVar + uxVar - uzVar));
    pizz_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pizz_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(pixz_I + piyz_I + pixy_I)) + (2.0/9.0) * (1.0 + 2.0*uzVar + uxVar + uyVar));  
    pixy_t90 = 9.0 * (inv_rho * ONETHIRD * (-3.0 * pixx_I -3.0 * piyy_I + 3.0* pizz_I + 17.0*pixy_I + pixz_I + piyz_I) - (2.0/9.0) * (1.0 + uyVar + uxVar - uzVar));
    pixz_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * pixx_I +3.0 * pizz_I - 3.0* piyy_I + 17.0*pixz_I + pixy_I - piyz_I) - (2.0/9.0) * (-1.0 + uzVar - uxVar - uyVar));
    piyz_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * piyy_I +3.0 * pizz_I - 3.0* pixx_I + 17.0*piyz_I + pixy_I - pixz_I) - (2.0/9.0) * (-1.0 + uzVar - uyVar - uxVar));

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;      
}

// l1 = -1
// l2 = -1
// l3 = +1
__device__ void 
gpuBCMomentSWF(*pop, &rhoVar, char dNodeType,
               &uxVar, &uyVar, &uzVar,
               &pixx, &pixy, &pixz,
               &piyy, &piyz, &pizz){
    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0; 

    //IO: 0/2/4/5/8/16/18
    rho_I = pop[0]  + pop[2] + pop[4] + pop[5] + pop[8] + pop[16]  + pop[18];
    inv_rho_I = 1.0 / rho_I;
    pixx_I = inv_rho_I *  (pop[2] + pop[8] + pop[16] - cs2*rho_I);
    pixy_I = inv_rho_I * (( pop[8]) );
    pixz_I = inv_rho_I * ( - ( pop[16])) ;
    piyy_I = inv_rho_I *  (pop[4] + pop[8] + pop[18] - cs2*rho_I);
    piyz_I = inv_rho_I * (- (pop[18]));
    pizz_I = inv_rho_I *  (pop[5] + pop[16] + pop[18] - cs2*rho_I);


    bE = (1.0/24.0)*(T_OMEGA)*(pixx_I + piyy_I + pizz_I 
                +2.0 * pixy_I + 2.0 * pixz_I - 2.0 * piyz_I);
    dE = 4.0 + 10.0*OMEGA + 4*(OMEGA-3.0)*(-uxVar - uyVar + uzVar) 
              - 9.0*OMEGA*(uxVar*uxVar + uyVar*uyVar + uzVar*uzVar) + 6.0* OMEGA *
              ( uxVar * uyVar - uxVar * uzVar - uyVar*uzVar);

    rho = rho_I * bE / dE; //A27
    inv_rho = 1.0/rho;    

    pixx_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pixx_I - 2.0*piyy_I - 2.0 * pizz_I + 6.0*(-pixy_I + pixz_I - piyz_I)) + (2.0/9.0) * (1.0 + 2.0*uxVar - uyVar + uzVar));
    piyy_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * piyy_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(-pixy_I + piyz_I - pixz_I)) + (2.0/9.0) * (1.0 + 2.0*uyVar - uxVar + uzVar));
    pizz_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pizz_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(pixz_I + piyz_I + pixy_I)) + (2.0/9.0) * (1.0 - 2.0*uzVar - uxVar - uyVar));
    pixy_t90 = 9.0 * (inv_rho * ONETHIRD * (-3.0 * pixx_I -3.0 * piyy_I + 3.0* pizz_I + 17.0*pixy_I + pixz_I + piyz_I) - (2.0/9.0) * (1.0 - uyVar - uxVar + uzVar));
    pixz_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * pixx_I +3.0 * pizz_I - 3.0* piyy_I + 17.0*pixz_I + pixy_I - piyz_I) - (2.0/9.0) * (-1.0 - uzVar + uxVar + uyVar));
    piyz_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * piyy_I +3.0 * pizz_I - 3.0* pixx_I + 17.0*piyz_I + pixy_I - pixz_I) - (2.0/9.0) * (-1.0 - uzVar - uyVar + uxVar));

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;    

}

// l1 = -1
// l2 = -1
// l3 = -1
__device__ void 
gpuBCMomentSWB(*pop, &rhoVar, char dNodeType,
               &uxVar, &uyVar, &uzVar,
               &pixx, &pixy, &pixz,
               &piyy, &piyz, &pizz){
    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0; 

    //IO: 0/2/4/6/8/10/12
    rho_I = pop[0]  + pop[2] + pop[4] + pop[6] + pop[8] + pop[10] + pop[12];
    inv_rho_I = 1.0 / rho_I;
    pixx_I = inv_rho_I *  (pop[2] + pop[8] + pop[10] - cs2*rho_I);
    pixy_I = inv_rho_I * ((pop[8]) );
    pixz_I = inv_rho_I * ((pop[10]) ) ;
    piyy_I = inv_rho_I *  (pop[4] + pop[8] + pop[12] - cs2*rho_I);
    piyz_I = inv_rho_I * ((pop[12]) );
    pizz_I = inv_rho_I *  (pop[6] + pop[10] + pop[12] - cs2*rho_I);
    

    bE = (1.0/24.0)*(T_OMEGA)*(pixx_I + piyy_I + pizz_I 
              +2.0 * pixy_I + 2.0 * pixz_I + 2.0 * piyz_I);
    dE = 4.0 + 10.0*OMEGA + 4*(OMEGA-3.0)*(-uxVar - uyVar - uzVar) 
              - 9.0*OMEGA*(uxVar*uxVar + uyVar*uyVar + uzVar*uzVar) + 6.0* OMEGA *
              ( uxVar * uyVar + uxVar * uzVar + uyVar*uzVar);

    rho = rho_I * bE / dE; //A27
    inv_rho = 1.0/rho;

    pixx_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pixx_I - 2.0*piyy_I - 2.0 * pizz_I + 6.0*(-pixy_I - pixz_I + piyz_I)) + (2.0/9.0) * (1.0 + 2.0*uxVar - uyVar - uzVar));
    piyy_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * piyy_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(-pixy_I - piyz_I + pixz_I)) + (2.0/9.0) * (1.0 + 2.0*uyVar - uxVar - uzVar));
    pizz_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pizz_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(-pixz_I - piyz_I + pixy_I)) + (2.0/9.0) * (1.0 + 2.0*uzVar - uxVar - uyVar)); 
    pixy_t90 = 9.0 * (inv_rho * ONETHIRD * (-3.0 * pixx_I -3.0 * piyy_I + 3.0* pizz_I + 17.0*pixy_I - pixz_I - piyz_I) - (2.0/9.0) * (1.0 - uyVar - uxVar - uzVar));
    pixz_t90 = 9.0 * (inv_rho * ONETHIRD * (-3.0 * pixx_I -3.0 * pizz_I + 3.0* piyy_I + 17.0*pixz_I - pixy_I - piyz_I) - (2.0/9.0) * (1.0 - uzVar - uxVar - uyVar));
    piyz_t90 = 9.0 * (inv_rho * ONETHIRD * (-3.0 * piyy_I -3.0 * pizz_I + 3.0* pixx_I + 17.0*piyz_I - pixy_I - pixz_I) - (2.0/9.0) * (1.0 - uzVar - uyVar - uxVar));

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;                     
}


// l1 = +1
// l2 = -1
// l3 = +1
__device__ void 
gpuBCMomentSEF(*pop, &rhoVar, char dNodeType,
               &uxVar, &uyVar, &uzVar,
               &pixx, &pixy, &pixz,
               &piyy, &piyz, &pizz){
    
    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0; 

    //IO: 0/1/4/5/9/13/18
    rho_I = pop[0] + pop[1] + pop[4] + pop[5] + pop[9] + pop[13] + pop[18];
    inv_rho_I = 1.0 / rho_I;
    pixx_I = inv_rho_I *  (pop[1] + pop[9] + pop[13]  - cs2*rho_I);
    pixy_I = inv_rho_I * ( - (pop[13]));
    pixz_I = inv_rho_I * ((pop[9]) ) ;
    piyy_I = inv_rho_I *  (pop[4] + pop[13] + pop[18] - cs2*rho_I);
    piyz_I = inv_rho_I * ( - (pop[18]));
    pizz_I = inv_rho_I *  (pop[5] + pop[9] + pop[18] - cs2*rho_I);


    bE = (1.0/24.0)*(T_OMEGA)*(pixx_I + piyy_I + pizz_I 
              -2.0 * pixy_I + 2.0 * pixz_I - 2.0 * piyz_I);
    dE = 4.0 + 10.0*OMEGA + 4*(OMEGA-3.0)*(uxVar - uyVar + uzVar) 
              - 9.0*OMEGA*(uxVar*uxVar + uyVar*uyVar + uzVar*uzVar) + 6.0* OMEGA *
              ( -uxVar * uyVar + uxVar * uzVar - uyVar*uzVar);

    rho = rho_I * bE / dE; //A27
    inv_rho = 1.0/rho; 

    pixx_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pixx_I - 2.0*piyy_I - 2.0 * pizz_I + 6.0*(pixy_I - pixz_I - piyz_I)) + (2.0/9.0) * (1.0 - 2.0*uxVar - uyVar + uzVar));
    piyy_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * piyy_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(pixy_I + piyz_I + pixz_I)) + (2.0/9.0) * (1.0 + 2.0*uyVar + uxVar + uzVar));
    pizz_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pizz_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(-pixz_I + piyz_I - pixy_I)) + (2.0/9.0) * (1.0 - 2.0*uzVar + uxVar - uyVar));
    pixy_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * pixx_I +3.0 * piyy_I - 3.0* pizz_I + 17.0*pixy_I - pixz_I - piyz_I) - (2.0/9.0) * (-1.0 + uyVar - uxVar + uzVar));
    pixz_t90 = 9.0 * (inv_rho * ONETHIRD * (-3.0 * pixx_I -3.0 * pizz_I + 3.0* piyy_I + 17.0*pixz_I + pixy_I + piyz_I) - (2.0/9.0) * (1.0 + uzVar + uxVar + uyVar));
    piyz_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * piyy_I +3.0 * pizz_I - 3.0* pixx_I + 17.0*piyz_I - pixy_I + pixz_I) - (2.0/9.0) * (-1.0 - uzVar + uyVar + uxVar));

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;                     
}

// l1 = +1
// l2 = -1
// l3 = -1
__device__ void 
gpuBCMomentSEB(*pop, &rhoVar, char dNodeType,
               &uxVar, &uyVar, &uzVar,
               &pixx, &pixy, &pixz,
               &piyy, &piyz, &pizz){
    
    uxVar = 0.0;  
    uyVar = 0.0;  
    uzVar = 0.0; 

    //IO: 0/1/4/6/12/13/15
    rho_I = pop[0] + pop[1]  + pop[4] + pop[6] + pop[12] + pop[13] + pop[15];
    inv_rho_I = 1.0 / rho_I;
    pixx_I = inv_rho_I *  (pop[1]  + pop[13] + pop[15] - cs2*rho_I);
    pixy_I = inv_rho_I * ( - (pop[13]));
    pixz_I = inv_rho_I * ( - (pop[15])) ;
    piyy_I = inv_rho_I *  (pop[4] + pop[12] + pop[13]  - cs2*rho_I);
    piyz_I = inv_rho_I * ((pop[12]));
    pizz_I = inv_rho_I *  ( pop[6] + pop[12] + pop[15] - cs2*rho_I);
    

    bE = (1.0/24.0)*(T_OMEGA)*(pixx_I + piyy_I + pizz_I 
              -2.0 * pixy_I + 2.0 * pixz_I + 2.0 * piyz_I);
    dE = 4.0 + 10.0*OMEGA + 4*(OMEGA-3.0)*(uxVar - uyVar - uzVar) 
              - 9.0*OMEGA*(uxVar*uxVar + uyVar*uyVar + uzVar*uzVar) + 6.0* OMEGA *
              ( -uxVar * uyVar - uxVar * uzVar + uyVar*uzVar);

    rho = rho_I * bE / dE; //A27
    inv_rho = 1.0/rho; 

    pixx_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pixx_I - 2.0*piyy_I - 2.0 * pizz_I + 6.0*(pixy_I + pixz_I + piyz_I)) + (2.0/9.0) * (1.0 - 2.0*uxVar - uyVar - uzVar));
    piyy_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * piyy_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(pixy_I - piyz_I - pixz_I)) + (2.0/9.0) * (1.0 + 2.0*uyVar + uxVar - uzVar));
    pizz_t45 = 4.5 * (inv_rho * ONETHIRD * rho_I * (10.0 * pizz_I - 2.0*pixx_I - 2.0 * pizz_I + 6.0*(pixz_I - piyz_I - pixy_I)) + (2.0/9.0) * (1.0 + 2.0*uzVar + uxVar - uyVar)); 
    pixy_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * pixx_I +3.0 * piyy_I - 3.0* pizz_I + 17.0*pixy_I - pixz_I + piyz_I) - (2.0/9.0) * (-1.0 + uyVar - uxVar + uzVar));
    pixz_t90 = 9.0 * (inv_rho * ONETHIRD * (+3.0 * pixx_I +3.0 * pizz_I - 3.0* piyy_I + 17.0*pixz_I - pixy_I + piyz_I) - (2.0/9.0) * (-1.0 + uzVar - uxVar + uyVar));
    piyz_t90 = 9.0 * (inv_rho * ONETHIRD * (-3.0 * piyy_I -3.0 * pizz_I + 3.0* pixx_I + 17.0*piyz_I + pixy_I + pixz_I) - (2.0/9.0) * (1.0 - uzVar - uyVar + uxVar));

                ux_t30 = uxVar * 3.0;
            uy_t30 = uyVar * 3.0;
            uz_t30 = uzVar * 3.0;

            rhoVar = rho;    
}
*/
